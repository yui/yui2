<head><title>API: editor   editor.js  (YUI Library)</title><link rel="stylesheet" type="text/css" href="assets/api.css"><script type="text/javascript" src="assets/api-js"></script><script type="text/javascript" src="assets/ac-js"></script></head><body id="yahoo-com"><div style="background: none repeat scroll 0 0 #355E95; border: 1px solid #B6CDE1; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3); color: #FFF; font: 177% Helvetica,Arial,sans-serif; margin: 0; padding: 0; text-align: center; white-space: nowrap; line-height: 1.2em;">
<p style="margin: 1em;">YUI recommends <a style="text-decoration: none; color: #F29752;" href="http://yuilibrary.com/">YUI 3.</a></p>
<p style="margin: 1em;">YUI 2 has been <a style="text-decoration: none; color: #F29752;" href="http://www.yuiblog.com/blog/2011/04/13/announcing-yui-2-9-0/">deprecated</a> since 2011. This site acts as an archive for files and documentation.</p>
</div><div id="doc3" class="yui-t2">

	<div id="hd">
        <a href="http://developer.yahoo.com/yui/"><h1>Yahoo! UI Library</h1></a>
        <h3>editorÂ  <span class="subtitle">2.4.0</span></h3>
        <p>
        <a href="./index.html">Yahoo! UI Library</a> 
            &gt; <a href="./module_editor.html">editor</a>
                
                 &gt; editor.js (source view) 
            </p>

	</div>

	<div id="bd">
		<div id="yui-main">
			<div class="yui-b">
            <form name="yui-classopts-form">
    <span id="classopts"><input type="checkbox" name="showprivate" id="showprivate"> Show Private</span>
    <span id="classopts"><input type="checkbox" name="showprotected" id="showprotected"> Show Protected</span>
            </form>

                    <div id="srcout">
                        <style>
                            #doc3 #classopts { display:none; }
                        </style><div class="highlight"><pre><span class="c">/**</span>
<span class="c"> * @module editor</span>
<span class="c"> * @description &lt;p&gt;The Rich Text Editor is a UI control that replaces a standard HTML textarea; it allows for the rich formatting of text content, including common structural treatments like lists, formatting treatments like bold and italic text, and drag-and-drop inclusion and sizing of images. The Rich Text Editor's toolbar is extensible via a plugin architecture so that advanced implementations can achieve a high degree of customization.&lt;/p&gt;</span>
<span class="c"> * @namespace YAHOO.widget</span>
<span class="c"> * @requires yahoo, dom, element, event, container_core, simpleeditor</span>
<span class="c"> * @optional dragdrop, animation, menu, button</span>
<span class="c"> * @beta</span>
<span class="c"> */</span>

<span class="o">(</span><span class="k">function</span><span class="o">()</span> <span class="o">{</span>
<span class="k">var</span> <span class="nx">Dom</span> <span class="o">=</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Dom</span><span class="o">,</span>
    <span class="nx">Event</span> <span class="o">=</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Event</span><span class="o">,</span>
    <span class="nx">Lang</span> <span class="o">=</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">lang</span><span class="o">,</span>
    <span class="nx">Toolbar</span> <span class="o">=</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">Toolbar</span><span class="o">;</span>

    <span class="c">/**</span>
<span class="c">     * The Rich Text Editor is a UI control that replaces a standard HTML textarea; it allows for the rich formatting of text content, including common structural treatments like lists, formatting treatments like bold and italic text, and drag-and-drop inclusion and sizing of images. The Rich Text Editor's toolbar is extensible via a plugin architecture so that advanced implementations can achieve a high degree of customization.</span>
<span class="c">     * @constructor</span>
<span class="c">     * @class Editor</span>
<span class="c">     * @extends YAHOO.widget.SimpleEditor</span>
<span class="c">     * @param {String/HTMLElement} el The textarea element to turn into an editor.</span>
<span class="c">     * @param {Object} attrs Object liternal containing configuration parameters.</span>
<span class="c">    */</span>
    
    <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">Editor</span> <span class="o">=</span> <span class="k">function</span><span class="o">(</span><span class="nx">el</span><span class="o">,</span> <span class="nx">attrs</span><span class="o">)</span> <span class="o">{</span>
        <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">'Editor Initalizing'</span><span class="o">,</span> <span class="s1">'info'</span><span class="o">,</span> <span class="s1">'Editor'</span><span class="o">);</span>
        
        <span class="k">var</span> <span class="nx">oConfig</span> <span class="o">=</span> <span class="o">{</span>
            <span class="nx">element</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
            <span class="nx">attributes</span><span class="o">:</span> <span class="o">(</span><span class="nx">attrs</span> <span class="o">||</span> <span class="o">{})</span>
        <span class="o">},</span> <span class="nx">id</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

        <span class="k">if</span> <span class="o">(</span><span class="nx">Lang</span><span class="o">.</span><span class="nx">isString</span><span class="o">(</span><span class="nx">el</span><span class="o">))</span> <span class="o">{</span>
            <span class="nx">id</span> <span class="o">=</span> <span class="nx">el</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="nx">id</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">id</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="nx">oConfig</span><span class="o">.</span><span class="nx">element</span> <span class="o">=</span> <span class="nx">el</span><span class="o">;</span>
        <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">Editor</span><span class="o">.</span><span class="nx">superclass</span><span class="o">.</span><span class="nx">constructor</span><span class="o">.</span><span class="nx">call</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="nx">oConfig</span><span class="o">.</span><span class="nx">element</span><span class="o">,</span> <span class="nx">oConfig</span><span class="o">.</span><span class="nx">attributes</span><span class="o">);</span>
    <span class="o">};</span>

    <span class="c">/**</span>
<span class="c">    * @private</span>
<span class="c">    * @method _cleanClassName</span>
<span class="c">    * @description Makes a useable classname from dynamic data, by dropping it to lowercase and replacing spaces with -'s.</span>
<span class="c">    * @param {String} str The classname to clean up</span>
<span class="c">    * @returns {String}</span>
<span class="c">    */</span>
    <span class="k">function</span> <span class="nx">_cleanClassName</span><span class="o">(</span><span class="nx">str</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nx">str</span><span class="o">.</span><span class="nx">replace</span><span class="o">(</span><span class="sr">/ /g</span><span class="o">,</span> <span class="s1">'-'</span><span class="o">).</span><span class="nx">toLowerCase</span><span class="o">();</span>
    <span class="o">}</span>


    <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">extend</span><span class="o">(</span><span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">Editor</span><span class="o">,</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">SimpleEditor</span><span class="o">,</span> <span class="o">{</span>
        <span class="c">/**</span>
<span class="c">        * @property STR_BEFORE_EDITOR</span>
<span class="c">        * @description The accessibility string for the element before the iFrame</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_BEFORE_EDITOR</span><span class="o">:</span> <span class="s1">'This text field can contain stylized text and graphics. To cycle through all formatting options, use the keyboard shortcut Control + Shift + T to place focus on the toolbar and navigate between option heading names. &lt;h4&gt;Common formatting keyboard shortcuts:&lt;/h4&gt;&lt;ul&gt;&lt;li&gt;Control Shift B sets text to bold&lt;/li&gt; &lt;li&gt;Control Shift I sets text to italic&lt;/li&gt; &lt;li&gt;Control Shift U underlines text&lt;/li&gt; &lt;li&gt;Control Shift [ aligns text left&lt;/li&gt; &lt;li&gt;Control Shift | centers text&lt;/li&gt; &lt;li&gt;Control Shift ] aligns text right&lt;/li&gt; &lt;li&gt;Control Shift L adds an HTML link&lt;/li&gt; &lt;li&gt;To exit this text editor use the keyboard shortcut Control + Shift + ESC.&lt;/li&gt;&lt;/ul&gt;'</span><span class="o">,</span>    
        <span class="c">/**</span>
<span class="c">        * @property STR_CLOSE_WINDOW</span>
<span class="c">        * @description The Title of the close button in the Editor Window</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_CLOSE_WINDOW</span><span class="o">:</span> <span class="s1">'Close Window'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @property STR_CLOSE_WINDOW_NOTE</span>
<span class="c">        * @description A note appearing in the Editor Window to tell the user that the Escape key will close the window</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_CLOSE_WINDOW_NOTE</span><span class="o">:</span> <span class="s1">'To close this window use the Control + Shift + W key'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @property STR_IMAGE_PROP_TITLE</span>
<span class="c">        * @description The title for the Image Property Editor Window</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_IMAGE_PROP_TITLE</span><span class="o">:</span> <span class="s1">'Image Options'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @property STR_IMAGE_URL</span>
<span class="c">        * @description The label string for Image URL</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_IMAGE_URL</span><span class="o">:</span> <span class="s1">'Image Url'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @property STR_IMAGE_TITLE</span>
<span class="c">        * @description The label string for Image Description</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_IMAGE_TITLE</span><span class="o">:</span> <span class="s1">'Description'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @property STR_IMAGE_SIZE</span>
<span class="c">        * @description The label string for Image Size</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_IMAGE_SIZE</span><span class="o">:</span> <span class="s1">'Size'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @property STR_IMAGE_ORIG_SIZE</span>
<span class="c">        * @description The label string for Original Image Size</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_IMAGE_ORIG_SIZE</span><span class="o">:</span> <span class="s1">'Original Size'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @property STR_IMAGE_COPY</span>
<span class="c">        * @description The label string for the image copy and paste message for Opera and Safari</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_IMAGE_COPY</span><span class="o">:</span> <span class="s1">'&lt;span class="tip"&gt;&lt;span class="icon icon-info"&gt;&lt;/span&gt;&lt;strong&gt;Note:&lt;/strong&gt;To move this image just highlight it, cut, and paste where ever you\'d like.&lt;/span&gt;'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @property STR_IMAGE_PADDING</span>
<span class="c">        * @description The label string for the image padding.</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_IMAGE_PADDING</span><span class="o">:</span> <span class="s1">'Padding'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @property STR_IMAGE_BORDER</span>
<span class="c">        * @description The label string for the image border.</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_IMAGE_BORDER</span><span class="o">:</span> <span class="s1">'Border'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @property STR_IMAGE_TEXTFLOW</span>
<span class="c">        * @description The label string for the image text flow.</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_IMAGE_TEXTFLOW</span><span class="o">:</span> <span class="s1">'Text Flow'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @property STR_LOCAL_FILE_WARNING</span>
<span class="c">        * @description The label string for the local file warning.</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_LOCAL_FILE_WARNING</span><span class="o">:</span> <span class="s1">'&lt;span class="tip"&gt;&lt;span class="icon icon-warn"&gt;&lt;/span&gt;&lt;strong&gt;Note:&lt;/strong&gt;This image/link points to a file on your computer and will not be accessible to others on the internet.&lt;/span&gt;'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @property STR_LINK_PROP_TITLE</span>
<span class="c">        * @description The label string for the Link Property Editor Window.</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_LINK_PROP_TITLE</span><span class="o">:</span> <span class="s1">'Link Options'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @property STR_LINK_PROP_REMOVE</span>
<span class="c">        * @description The label string for the Remove link from text link inside the property editor.</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_LINK_PROP_REMOVE</span><span class="o">:</span> <span class="s1">'Remove link from text'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @property STR_LINK_NEW_WINDOW</span>
<span class="c">        * @description The string for the open in a new window label.</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_LINK_NEW_WINDOW</span><span class="o">:</span> <span class="s1">'Open in a new window.'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @property STR_LINK_TITLE</span>
<span class="c">        * @description The string for the link description.</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">STR_LINK_TITLE</span><span class="o">:</span> <span class="s1">'Description'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @protected</span>
<span class="c">        * @property CLASS_LOCAL_FILE</span>
<span class="c">        * @description CSS class applied to an element when it's found to have a local url.</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">CLASS_LOCAL_FILE</span><span class="o">:</span> <span class="s1">'warning-localfile'</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @protected</span>
<span class="c">        * @property CLASS_HIDDEN</span>
<span class="c">        * @description CSS class applied to the body when the hiddenelements button is pressed.</span>
<span class="c">        * @type String</span>
<span class="c">        */</span>
        <span class="nx">CLASS_HIDDEN</span><span class="o">:</span> <span class="s1">'yui-hidden'</span><span class="o">,</span>
        <span class="c">/** </span>
<span class="c">        * @method init</span>
<span class="c">        * @description The Editor class' initialization method</span>
<span class="c">        */</span>
        <span class="nx">init</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">p_oElement</span><span class="o">,</span> <span class="nx">p_oAttributes</span><span class="o">)</span> <span class="o">{</span>
            <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">'init'</span><span class="o">,</span> <span class="s1">'info'</span><span class="o">,</span> <span class="s1">'Editor'</span><span class="o">);</span>
            <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">Editor</span><span class="o">.</span><span class="nx">superclass</span><span class="o">.</span><span class="nx">init</span><span class="o">.</span><span class="nx">call</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="nx">p_oElement</span><span class="o">,</span> <span class="nx">p_oAttributes</span><span class="o">);</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @method initAttributes</span>
<span class="c">        * @description Initializes all of the configuration attributes used to create </span>
<span class="c">        * the editor.</span>
<span class="c">        * @param {Object} attr Object literal specifying a set of </span>
<span class="c">        * configuration attributes used to create the editor.</span>
<span class="c">        */</span>
        <span class="nx">initAttributes</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">attr</span><span class="o">)</span> <span class="o">{</span>
            <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">Editor</span><span class="o">.</span><span class="nx">superclass</span><span class="o">.</span><span class="nx">initAttributes</span><span class="o">.</span><span class="nx">call</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="nx">attr</span><span class="o">);</span>

            <span class="c">/**</span>
<span class="c">            * @attribute localFileWarning</span>
<span class="c">            * @description Should we throw the warning if we detect a file that is local to their machine?</span>
<span class="c">            * @default true</span>
<span class="c">            * @type Boolean</span>
<span class="c">            */</span>            
            <span class="k">this</span><span class="o">.</span><span class="nx">setAttributeConfig</span><span class="o">(</span><span class="s1">'localFileWarning'</span><span class="o">,</span> <span class="o">{</span>
                <span class="nx">value</span><span class="o">:</span> <span class="nx">attr</span><span class="o">.</span><span class="nx">locaFileWarning</span> <span class="o">||</span> <span class="kc">true</span>
            <span class="o">});</span>

            <span class="c">/**</span>
<span class="c">            * @attribute hiddencss</span>
<span class="c">            * @description The CSS used to show/hide hidden elements on the page, these rules must be prefixed with the class provided in &lt;code&gt;this.CLASS_HIDDEN&lt;/code&gt;</span>
<span class="c">            * @default &lt;code&gt;&lt;pre&gt;</span>
<span class="c">            .yui-hidden font, .yui-hidden strong, .yui-hidden b, .yui-hidden em, .yui-hidden i, .yui-hidden u, .yui-hidden div, .yui-hidden p, .yui-hidden span, .yui-hidden img, .yui-hidden ul, .yui-hidden ol, .yui-hidden li, .yui-hidden table {</span>
<span class="c">                border: 1px dotted #ccc;</span>
<span class="c">            }</span>
<span class="c">            .yui-hidden .yui-non {</span>
<span class="c">                border: none;</span>
<span class="c">            }</span>
<span class="c">            .yui-hidden img {</span>
<span class="c">                padding: 2px;</span>
<span class="c">            }&lt;/pre&gt;&lt;/code&gt;</span>
<span class="c">            * @type String</span>
<span class="c">            */</span>            
            <span class="k">this</span><span class="o">.</span><span class="nx">setAttributeConfig</span><span class="o">(</span><span class="s1">'hiddencss'</span><span class="o">,</span> <span class="o">{</span>
                <span class="nx">value</span><span class="o">:</span> <span class="nx">attr</span><span class="o">.</span><span class="nx">hiddencss</span> <span class="o">||</span> <span class="s1">'.yui-hidden font, .yui-hidden strong, .yui-hidden b, .yui-hidden em, .yui-hidden i, .yui-hidden u, .yui-hidden div,.yui-hidden p,.yui-hidden span,.yui-hidden img, .yui-hidden ul, .yui-hidden ol, .yui-hidden li, .yui-hidden table { border: 1px dotted #ccc; } .yui-hidden .yui-non { border: none; } .yui-hidden img { padding: 2px; }'</span><span class="o">,</span>
                <span class="nx">writeOnce</span><span class="o">:</span> <span class="kc">true</span>
            <span class="o">});</span>
           
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @private</span>
<span class="c">        * @method _fixNodes</span>
<span class="c">        * @description Fix href and imgs as well as remove invalid HTML.</span>
<span class="c">        */</span>
        <span class="nx">_fixNodes</span><span class="o">:</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
            <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">Editor</span><span class="o">.</span><span class="nx">superclass</span><span class="o">.</span><span class="nx">_fixNodes</span><span class="o">.</span><span class="nx">call</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
            <span class="k">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="s1">''</span><span class="o">;</span>

            <span class="k">var</span> <span class="nx">imgs</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_getDoc</span><span class="o">().</span><span class="nx">getElementsByTagName</span><span class="o">(</span><span class="s1">'img'</span><span class="o">);</span>
            <span class="k">for</span> <span class="o">(</span><span class="k">var</span> <span class="nx">im</span> <span class="o">=</span> <span class="m">0</span><span class="o">;</span> <span class="nx">im</span> <span class="o">&lt;</span> <span class="nx">imgs</span><span class="o">.</span><span class="nx">length</span><span class="o">;</span> <span class="nx">im</span><span class="o">++)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="nx">imgs</span><span class="o">[</span><span class="nx">im</span><span class="o">].</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'href'</span><span class="o">,</span> <span class="m">2</span><span class="o">))</span> <span class="o">{</span>
                    <span class="nx">url</span> <span class="o">=</span> <span class="nx">imgs</span><span class="o">[</span><span class="nx">im</span><span class="o">].</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'src'</span><span class="o">,</span> <span class="m">2</span><span class="o">);</span>
                    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_isLocalFile</span><span class="o">(</span><span class="nx">url</span><span class="o">))</span> <span class="o">{</span>
                        <span class="nx">Dom</span><span class="o">.</span><span class="nx">addClass</span><span class="o">(</span><span class="nx">imgs</span><span class="o">[</span><span class="nx">im</span><span class="o">],</span> <span class="k">this</span><span class="o">.</span><span class="nx">CLASS_LOCAL_FILE</span><span class="o">);</span>
                    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                        <span class="nx">Dom</span><span class="o">.</span><span class="nx">removeClass</span><span class="o">(</span><span class="nx">imgs</span><span class="o">[</span><span class="nx">im</span><span class="o">],</span> <span class="k">this</span><span class="o">.</span><span class="nx">CLASS_LOCAL_FILE</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">var</span> <span class="nx">fakeAs</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_getDoc</span><span class="o">().</span><span class="nx">body</span><span class="o">.</span><span class="nx">getElementsByTagName</span><span class="o">(</span><span class="s1">'a'</span><span class="o">);</span>
            <span class="k">for</span> <span class="o">(</span><span class="k">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="m">0</span><span class="o">;</span> <span class="nx">a</span> <span class="o">&lt;</span> <span class="nx">fakeAs</span><span class="o">.</span><span class="nx">length</span><span class="o">;</span> <span class="nx">a</span><span class="o">++)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="nx">fakeAs</span><span class="o">[</span><span class="nx">a</span><span class="o">].</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'href'</span><span class="o">,</span> <span class="m">2</span><span class="o">))</span> <span class="o">{</span>
                    <span class="nx">url</span> <span class="o">=</span> <span class="nx">fakeAs</span><span class="o">[</span><span class="nx">a</span><span class="o">].</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'href'</span><span class="o">,</span> <span class="m">2</span><span class="o">);</span>
                    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_isLocalFile</span><span class="o">(</span><span class="nx">url</span><span class="o">))</span> <span class="o">{</span>
                        <span class="nx">Dom</span><span class="o">.</span><span class="nx">addClass</span><span class="o">(</span><span class="nx">fakeAs</span><span class="o">[</span><span class="nx">a</span><span class="o">],</span> <span class="k">this</span><span class="o">.</span><span class="nx">CLASS_LOCAL_FILE</span><span class="o">);</span>
                    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                        <span class="nx">Dom</span><span class="o">.</span><span class="nx">removeClass</span><span class="o">(</span><span class="nx">fakeAs</span><span class="o">[</span><span class="nx">a</span><span class="o">],</span> <span class="k">this</span><span class="o">.</span><span class="nx">CLASS_LOCAL_FILE</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @private</span>
<span class="c">        * @property _disabled</span>
<span class="c">        * @description The Toolbar items that should be disabled if there is no selection present in the editor.</span>
<span class="c">        * @type Array</span>
<span class="c">        */</span>
        <span class="nx">_disabled</span><span class="o">:</span> <span class="o">[</span> <span class="s1">'createlink'</span><span class="o">,</span> <span class="s1">'forecolor'</span><span class="o">,</span> <span class="s1">'backcolor'</span><span class="o">,</span> <span class="s1">'fontname'</span><span class="o">,</span> <span class="s1">'fontsize'</span><span class="o">,</span> <span class="s1">'superscript'</span><span class="o">,</span> <span class="s1">'subscript'</span><span class="o">,</span> <span class="s1">'removeformat'</span><span class="o">,</span> <span class="s1">'heading'</span><span class="o">,</span> <span class="s1">'indent'</span> <span class="o">],</span>
        <span class="c">/**</span>
<span class="c">        * @private</span>
<span class="c">        * @property _alwaysDisabled</span>
<span class="c">        * @description The Toolbar items that should ALWAYS be disabled event if there is a selection present in the editor.</span>
<span class="c">        * @type Object</span>
<span class="c">        */</span>
        <span class="nx">_alwaysDisabled</span><span class="o">:</span> <span class="o">{</span> <span class="s1">'outdent'</span><span class="o">:</span> <span class="kc">true</span> <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @private</span>
<span class="c">        * @property _alwaysEnabled</span>
<span class="c">        * @description The Toolbar items that should ALWAYS be enabled event if there isn't a selection present in the editor.</span>
<span class="c">        * @type Object</span>
<span class="c">        */</span>
        <span class="nx">_alwaysEnabled</span><span class="o">:</span> <span class="o">{</span> <span class="nx">hiddenelements</span><span class="o">:</span> <span class="kc">true</span> <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @property _defaultToolbar</span>
<span class="c">        * @private</span>
<span class="c">        * @description Default toolbar config.</span>
<span class="c">        * @type Object</span>
<span class="c">        */</span>
        <span class="nx">_defaultToolbar</span><span class="o">:</span> <span class="o">{</span>
            <span class="nx">collapse</span><span class="o">:</span> <span class="kc">true</span><span class="o">,</span>
            <span class="nx">titlebar</span><span class="o">:</span> <span class="s1">'Text Editing Tools'</span><span class="o">,</span>
            <span class="nx">draggable</span><span class="o">:</span> <span class="kc">false</span><span class="o">,</span>
            <span class="nx">buttonType</span><span class="o">:</span> <span class="s1">'advanced'</span><span class="o">,</span>
            <span class="nx">buttons</span><span class="o">:</span> <span class="o">[</span>
                <span class="o">{</span> <span class="nx">group</span><span class="o">:</span> <span class="s1">'fontstyle'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Font Name and Size'</span><span class="o">,</span>
                    <span class="nx">buttons</span><span class="o">:</span> <span class="o">[</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'select'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Arial'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'fontname'</span><span class="o">,</span> <span class="nx">disabled</span><span class="o">:</span> <span class="kc">true</span><span class="o">,</span>
                            <span class="nx">menu</span><span class="o">:</span> <span class="o">[</span>
                                <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Arial'</span><span class="o">,</span> <span class="nx">checked</span><span class="o">:</span> <span class="kc">true</span> <span class="o">},</span>
                                <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Arial Black'</span> <span class="o">},</span>
                                <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Comic Sans MS'</span> <span class="o">},</span>
                                <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Courier New'</span> <span class="o">},</span>
                                <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Lucida Console'</span> <span class="o">},</span>
                                <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Tahoma'</span> <span class="o">},</span>
                                <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Times New Roman'</span> <span class="o">},</span>
                                <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Trebuchet MS'</span> <span class="o">},</span>
                                <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Verdana'</span> <span class="o">}</span>
                            <span class="o">]</span>
                        <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'spin'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'13'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'fontsize'</span><span class="o">,</span> <span class="nx">range</span><span class="o">:</span> <span class="o">[</span> <span class="m">9</span><span class="o">,</span> <span class="m">75</span> <span class="o">],</span> <span class="nx">disabled</span><span class="o">:</span> <span class="kc">true</span> <span class="o">}</span>
                    <span class="o">]</span>
                <span class="o">},</span>
                <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'separator'</span> <span class="o">},</span>
                <span class="o">{</span> <span class="nx">group</span><span class="o">:</span> <span class="s1">'textstyle'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Font Style'</span><span class="o">,</span>
                    <span class="nx">buttons</span><span class="o">:</span> <span class="o">[</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Bold CTRL + SHIFT + B'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'bold'</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Italic CTRL + SHIFT + I'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'italic'</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Underline CTRL + SHIFT + U'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'underline'</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'separator'</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Subscript'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'subscript'</span><span class="o">,</span> <span class="nx">disabled</span><span class="o">:</span> <span class="kc">true</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Superscript'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'superscript'</span><span class="o">,</span> <span class="nx">disabled</span><span class="o">:</span> <span class="kc">true</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'separator'</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'color'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Font Color'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'forecolor'</span><span class="o">,</span> <span class="nx">disabled</span><span class="o">:</span> <span class="kc">true</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'color'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Background Color'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'backcolor'</span><span class="o">,</span> <span class="nx">disabled</span><span class="o">:</span> <span class="kc">true</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'separator'</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Remove Formatting'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'removeformat'</span><span class="o">,</span> <span class="nx">disabled</span><span class="o">:</span> <span class="kc">true</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Show/Hide Hidden Elements'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'hiddenelements'</span> <span class="o">}</span>
                    <span class="o">]</span>
                <span class="o">},</span>
                <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'separator'</span> <span class="o">},</span>
                <span class="o">{</span> <span class="nx">group</span><span class="o">:</span> <span class="s1">'alignment'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Alignment'</span><span class="o">,</span>
                    <span class="nx">buttons</span><span class="o">:</span> <span class="o">[</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Align Left CTRL + SHIFT + ['</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'justifyleft'</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Align Center CTRL + SHIFT + |'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'justifycenter'</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Align Right CTRL + SHIFT + ]'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'justifyright'</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Justify'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'justifyfull'</span> <span class="o">}</span>
                    <span class="o">]</span>
                <span class="o">},</span>
                <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'separator'</span> <span class="o">},</span>
                <span class="o">{</span> <span class="nx">group</span><span class="o">:</span> <span class="s1">'parastyle'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Paragraph Style'</span><span class="o">,</span>
                    <span class="nx">buttons</span><span class="o">:</span> <span class="o">[</span>
                    <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'select'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Normal'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'heading'</span><span class="o">,</span> <span class="nx">disabled</span><span class="o">:</span> <span class="kc">true</span><span class="o">,</span>
                        <span class="nx">menu</span><span class="o">:</span> <span class="o">[</span>
                            <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Normal'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'none'</span><span class="o">,</span> <span class="nx">checked</span><span class="o">:</span> <span class="kc">true</span> <span class="o">},</span>
                            <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Header 1'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'h1'</span> <span class="o">},</span>
                            <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Header 2'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'h2'</span> <span class="o">},</span>
                            <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Header 3'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'h3'</span> <span class="o">},</span>
                            <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Header 4'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'h4'</span> <span class="o">},</span>
                            <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Header 5'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'h5'</span> <span class="o">},</span>
                            <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Header 6'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'h6'</span> <span class="o">}</span>
                        <span class="o">]</span>
                    <span class="o">}</span>
                    <span class="o">]</span>
                <span class="o">},</span>
                <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'separator'</span> <span class="o">},</span>
                <span class="o">{</span> <span class="nx">group</span><span class="o">:</span> <span class="s1">'indentlist'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Indenting and Lists'</span><span class="o">,</span>
                    <span class="nx">buttons</span><span class="o">:</span> <span class="o">[</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Indent'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'indent'</span><span class="o">,</span> <span class="nx">disabled</span><span class="o">:</span> <span class="kc">true</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Outdent'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'outdent'</span><span class="o">,</span> <span class="nx">disabled</span><span class="o">:</span> <span class="kc">true</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Create an Unordered List'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'insertunorderedlist'</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Create an Ordered List'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'insertorderedlist'</span> <span class="o">}</span>
                    <span class="o">]</span>
                <span class="o">},</span>
                <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'separator'</span> <span class="o">},</span>
                <span class="o">{</span> <span class="nx">group</span><span class="o">:</span> <span class="s1">'insertitem'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Insert Item'</span><span class="o">,</span>
                    <span class="nx">buttons</span><span class="o">:</span> <span class="o">[</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'HTML Link CTRL + SHIFT + L'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'createlink'</span><span class="o">,</span> <span class="nx">disabled</span><span class="o">:</span> <span class="kc">true</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Insert Image'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'insertimage'</span> <span class="o">}</span>
                    <span class="o">]</span>
                <span class="o">}</span>
            <span class="o">]</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @private</span>
<span class="c">        * @method _handleKeyDown</span>
<span class="c">        * @param {Event} ev The event we are working on.</span>
<span class="c">        * @description Override method that handles some new keydown events inside the iFrame document.</span>
<span class="c">        */</span>
        <span class="nx">_handleKeyDown</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">ev</span><span class="o">)</span> <span class="o">{</span>
            <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">Editor</span><span class="o">.</span><span class="nx">superclass</span><span class="o">.</span><span class="nx">_handleKeyDown</span><span class="o">.</span><span class="nx">call</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="nx">ev</span><span class="o">);</span>
            <span class="k">var</span> <span class="nx">doExec</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span>
                <span class="nx">action</span> <span class="o">=</span> <span class="kc">null</span><span class="o">,</span>
                <span class="nx">exec</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

            <span class="k">if</span> <span class="o">(</span><span class="nx">ev</span><span class="o">.</span><span class="nx">shiftKey</span> <span class="o">&amp;&amp;</span> <span class="nx">ev</span><span class="o">.</span><span class="nx">ctrlKey</span><span class="o">)</span> <span class="o">{</span>
                <span class="nx">doExec</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="nx">switch</span> <span class="o">(</span><span class="nx">ev</span><span class="o">.</span><span class="nx">keyCode</span><span class="o">)</span> <span class="o">{</span>
                <span class="nx">case</span> <span class="m">219</span><span class="o">:</span> <span class="c">//Left</span>
<span class="c"></span>                    <span class="nx">action</span> <span class="o">=</span> <span class="s1">'justifyleft'</span><span class="o">;</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="nx">case</span> <span class="m">220</span><span class="o">:</span> <span class="c">//Center</span>
<span class="c"></span>                    <span class="nx">action</span> <span class="o">=</span> <span class="s1">'justifycenter'</span><span class="o">;</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="nx">case</span> <span class="m">221</span><span class="o">:</span> <span class="c">//Right</span>
<span class="c"></span>                    <span class="nx">action</span> <span class="o">=</span> <span class="s1">'justifyright'</span><span class="o">;</span>
                    <span class="k">break</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(</span><span class="nx">doExec</span> <span class="o">&amp;&amp;</span> <span class="nx">action</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">execCommand</span><span class="o">(</span><span class="nx">action</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
                <span class="nx">Event</span><span class="o">.</span><span class="nx">stopEvent</span><span class="o">(</span><span class="nx">ev</span><span class="o">);</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">nodeChange</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">},</span>        
        <span class="nx">_handleCreateLinkClick</span><span class="o">:</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_getSelectedElement</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_isElement</span><span class="o">(</span><span class="nx">el</span><span class="o">,</span> <span class="s1">'img'</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">STOP_EXEC_COMMAND</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">=</span> <span class="nx">el</span><span class="o">;</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">toolbar</span><span class="o">.</span><span class="nx">fireEvent</span><span class="o">(</span><span class="s1">'insertimageClick'</span><span class="o">,</span> <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'insertimageClick'</span><span class="o">,</span> <span class="nx">target</span><span class="o">:</span> <span class="k">this</span><span class="o">.</span><span class="nx">toolbar</span> <span class="o">});</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">fireEvent</span><span class="o">(</span><span class="s1">'afterExecCommand'</span><span class="o">,</span> <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'afterExecCommand'</span><span class="o">,</span> <span class="nx">target</span><span class="o">:</span> <span class="k">this</span> <span class="o">});</span>
                <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'limitCommands'</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(!</span><span class="k">this</span><span class="o">.</span><span class="nx">toolbar</span><span class="o">.</span><span class="nx">getButtonByValue</span><span class="o">(</span><span class="s1">'createlink'</span><span class="o">))</span> <span class="o">{</span>
                    <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">'Toolbar Button for (createlink) was not found, skipping exec.'</span><span class="o">,</span> <span class="s1">'info'</span><span class="o">,</span> <span class="s1">'Editor'</span><span class="o">);</span>
                    <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
            
            <span class="k">this</span><span class="o">.</span><span class="nx">on</span><span class="o">(</span><span class="s1">'afterExecCommand'</span><span class="o">,</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>

                <span class="k">var</span> <span class="nx">win</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">EditorWindow</span><span class="o">(</span><span class="s1">'createlink'</span><span class="o">,</span> <span class="o">{</span>
                    <span class="nx">width</span><span class="o">:</span> <span class="s1">'350px'</span>
                <span class="o">});</span>
                
                <span class="k">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">],</span>
                    <span class="nx">url</span> <span class="o">=</span> <span class="s1">''</span><span class="o">,</span>
                    <span class="nx">title</span> <span class="o">=</span> <span class="s1">''</span><span class="o">,</span>
                    <span class="nx">target</span> <span class="o">=</span> <span class="s1">''</span><span class="o">,</span>
                    <span class="nx">localFile</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
                <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'href'</span><span class="o">,</span> <span class="m">2</span><span class="o">)</span> <span class="o">!==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">url</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'href'</span><span class="o">,</span> <span class="m">2</span><span class="o">);</span>
                        <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_isLocalFile</span><span class="o">(</span><span class="nx">url</span><span class="o">))</span> <span class="o">{</span>
                            <span class="c">//Local File throw Warning</span>
<span class="c"></span>                            <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">'Local file reference found, show local warning'</span><span class="o">,</span> <span class="s1">'warn'</span><span class="o">,</span> <span class="s1">'Editor'</span><span class="o">);</span>
                            <span class="nx">win</span><span class="o">.</span><span class="nx">setFooter</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">STR_LOCAL_FILE_WARNING</span><span class="o">);</span>
                            <span class="nx">localFile</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
                        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                            <span class="nx">win</span><span class="o">.</span><span class="nx">setFooter</span><span class="o">(</span><span class="s1">' '</span><span class="o">);</span>
                        <span class="o">}</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'title'</span><span class="o">)</span> <span class="o">!==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">title</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'title'</span><span class="o">);</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'target'</span><span class="o">)</span> <span class="o">!==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">target</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'target'</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">}</span>
                <span class="k">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">'&lt;label for="createlink_url"&gt;&lt;strong&gt;'</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_LINK_URL</span> <span class="o">+</span> <span class="s1">':&lt;/strong&gt; &lt;input type="text" name="createlink_url" id="createlink_url" value="'</span> <span class="o">+</span> <span class="nx">url</span> <span class="o">+</span> <span class="s1">'"'</span> <span class="o">+</span> <span class="o">((</span><span class="nx">localFile</span><span class="o">)</span> <span class="o">?</span> <span class="s1">' class="warning"'</span> <span class="o">:</span> <span class="s1">''</span><span class="o">)</span> <span class="o">+</span> <span class="s1">'&gt;&lt;/label&gt;'</span><span class="o">;</span>
                <span class="nx">str</span> <span class="o">+=</span> <span class="s1">'&lt;label for="createlink_target"&gt;&lt;strong&gt;&amp;nbsp;&lt;/strong&gt;&lt;input type="checkbox" name="createlink_target_" id="createlink_target" value="_blank"'</span> <span class="o">+</span> <span class="o">((</span><span class="nx">target</span><span class="o">)</span> <span class="o">?</span> <span class="s1">' checked'</span> <span class="o">:</span> <span class="s1">''</span><span class="o">)</span> <span class="o">+</span> <span class="s1">'&gt; '</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_LINK_NEW_WINDOW</span> <span class="o">+</span> <span class="s1">'&lt;/label&gt;'</span><span class="o">;</span>
                <span class="nx">str</span> <span class="o">+=</span> <span class="s1">'&lt;label for="createlink_title"&gt;&lt;strong&gt;'</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_LINK_TITLE</span> <span class="o">+</span> <span class="s1">':&lt;/strong&gt; &lt;input type="text" name="createlink_title" id="createlink_title" value="'</span> <span class="o">+</span> <span class="nx">title</span> <span class="o">+</span> <span class="s1">'"&gt;&lt;/label&gt;'</span><span class="o">;</span>
                
                <span class="k">var</span> <span class="nx">body</span> <span class="o">=</span> <span class="nb">document</span><span class="o">.</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'div'</span><span class="o">);</span>
                <span class="nx">body</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">str</span><span class="o">;</span>

                <span class="k">var</span> <span class="nx">unlinkCont</span> <span class="o">=</span> <span class="nb">document</span><span class="o">.</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'div'</span><span class="o">);</span>
                <span class="nx">unlinkCont</span><span class="o">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">'removeLink'</span><span class="o">;</span>
                <span class="k">var</span> <span class="nx">unlink</span> <span class="o">=</span> <span class="nb">document</span><span class="o">.</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'a'</span><span class="o">);</span>
                <span class="nx">unlink</span><span class="o">.</span><span class="nx">href</span> <span class="o">=</span> <span class="s1">'#'</span><span class="o">;</span>
                <span class="nx">unlink</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_LINK_PROP_REMOVE</span><span class="o">;</span>
                <span class="nx">unlink</span><span class="o">.</span><span class="nx">title</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_LINK_PROP_REMOVE</span><span class="o">;</span>
                <span class="nx">Event</span><span class="o">.</span><span class="nx">on</span><span class="o">(</span><span class="nx">unlink</span><span class="o">,</span> <span class="s1">'click'</span><span class="o">,</span> <span class="k">function</span><span class="o">(</span><span class="nx">ev</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nx">Event</span><span class="o">.</span><span class="nx">stopEvent</span><span class="o">(</span><span class="nx">ev</span><span class="o">);</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">execCommand</span><span class="o">(</span><span class="s1">'unlink'</span><span class="o">);</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">closeWindow</span><span class="o">();</span>
                <span class="o">},</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
                <span class="nx">unlinkCont</span><span class="o">.</span><span class="nx">appendChild</span><span class="o">(</span><span class="nx">unlink</span><span class="o">);</span>
                <span class="nx">body</span><span class="o">.</span><span class="nx">appendChild</span><span class="o">(</span><span class="nx">unlinkCont</span><span class="o">);</span>

                <span class="nx">win</span><span class="o">.</span><span class="nx">setHeader</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">STR_LINK_PROP_TITLE</span><span class="o">);</span>
                <span class="nx">win</span><span class="o">.</span><span class="nx">setBody</span><span class="o">(</span><span class="nx">body</span><span class="o">);</span>

                <span class="nx">Event</span><span class="o">.</span><span class="nx">onAvailable</span><span class="o">(</span><span class="s1">'createlink_url'</span><span class="o">,</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                    <span class="nb">window</span><span class="o">.</span><span class="nx">setTimeout</span><span class="o">(</span><span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                        <span class="k">try</span> <span class="o">{</span>
                            <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'createlink_url'</span><span class="o">).</span><span class="nx">focus</span><span class="o">();</span>
                        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nx">e</span><span class="o">)</span> <span class="o">{}</span>
                    <span class="o">},</span> <span class="m">50</span><span class="o">);</span>
                    <span class="nx">Event</span><span class="o">.</span><span class="nx">on</span><span class="o">(</span><span class="s1">'createlink_url'</span><span class="o">,</span> <span class="s1">'blur'</span><span class="o">,</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                        <span class="k">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'createlink_url'</span><span class="o">);</span>
                        <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_isLocalFile</span><span class="o">(</span><span class="nx">url</span><span class="o">.</span><span class="nx">value</span><span class="o">))</span> <span class="o">{</span>
                            <span class="c">//Local File throw Warning</span>
<span class="c"></span>                            <span class="nx">Dom</span><span class="o">.</span><span class="nx">addClass</span><span class="o">(</span><span class="nx">url</span><span class="o">,</span> <span class="s1">'warning'</span><span class="o">);</span>
                            <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">'Local file reference found, show local warning'</span><span class="o">,</span> <span class="s1">'warn'</span><span class="o">,</span> <span class="s1">'Editor'</span><span class="o">);</span>
                            <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">setFooter</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">STR_LOCAL_FILE_WARNING</span><span class="o">);</span>
                        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                            <span class="nx">Dom</span><span class="o">.</span><span class="nx">removeClass</span><span class="o">(</span><span class="nx">url</span><span class="o">,</span> <span class="s1">'warning'</span><span class="o">);</span>
                            <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">setFooter</span><span class="o">(</span><span class="s1">' '</span><span class="o">);</span>
                        <span class="o">}</span>
                    <span class="o">},</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
                <span class="o">},</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>

                <span class="k">this</span><span class="o">.</span><span class="nx">openWindow</span><span class="o">(</span><span class="nx">win</span><span class="o">);</span>
            <span class="o">});</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @private</span>
<span class="c">        * @method _handleCreateLinkWindowClose</span>
<span class="c">        * @description Handles the closing of the Link Properties Window.</span>
<span class="c">        */</span>
        <span class="nx">_handleCreateLinkWindowClose</span><span class="o">:</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'createlink_url'</span><span class="o">),</span>
                <span class="nx">target</span> <span class="o">=</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'createlink_target'</span><span class="o">),</span>
                <span class="nx">title</span> <span class="o">=</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'createlink_title'</span><span class="o">),</span>
                <span class="nx">el</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">],</span>
                <span class="nx">a</span> <span class="o">=</span> <span class="nx">el</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="nx">url</span> <span class="o">&amp;&amp;</span> <span class="nx">url</span><span class="o">.</span><span class="nx">value</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">var</span> <span class="nx">urlValue</span> <span class="o">=</span> <span class="nx">url</span><span class="o">.</span><span class="nx">value</span><span class="o">;</span>
                <span class="k">if</span> <span class="o">((</span><span class="nx">urlValue</span><span class="o">.</span><span class="nx">indexOf</span><span class="o">(</span><span class="s1">':/'</span><span class="o">+</span><span class="s1">'/'</span><span class="o">)</span> <span class="o">==</span> <span class="o">-</span><span class="m">1</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="nx">urlValue</span><span class="o">.</span><span class="nx">substring</span><span class="o">(</span><span class="m">0</span><span class="o">,</span><span class="m">1</span><span class="o">)</span> <span class="o">!=</span> <span class="s1">'/'</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="nx">urlValue</span><span class="o">.</span><span class="nx">substring</span><span class="o">(</span><span class="m">0</span><span class="o">,</span> <span class="m">6</span><span class="o">).</span><span class="nx">toLowerCase</span><span class="o">()</span> <span class="o">!=</span> <span class="s1">'mailto'</span><span class="o">))</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">((</span><span class="nx">urlValue</span><span class="o">.</span><span class="nx">indexOf</span><span class="o">(</span><span class="s1">'@'</span><span class="o">)</span> <span class="o">!=</span> <span class="o">-</span><span class="m">1</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="nx">urlValue</span><span class="o">.</span><span class="nx">substring</span><span class="o">(</span><span class="m">0</span><span class="o">,</span> <span class="m">6</span><span class="o">).</span><span class="nx">toLowerCase</span><span class="o">()</span> <span class="o">!=</span> <span class="s1">'mailto'</span><span class="o">))</span> <span class="o">{</span>
                        <span class="c">//Found an @ sign, prefix with mailto:</span>
<span class="c"></span>                        <span class="nx">urlValue</span> <span class="o">=</span> <span class="s1">'mailto:'</span> <span class="o">+</span> <span class="nx">urlValue</span><span class="o">;</span>
                    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                        <span class="c">/* :// not found adding */</span>
                        <span class="k">if</span> <span class="o">(</span><span class="nx">urlValue</span><span class="o">.</span><span class="nx">substring</span><span class="o">(</span><span class="m">0</span><span class="o">,</span> <span class="m">1</span><span class="o">)</span> <span class="o">!=</span> <span class="s1">'#'</span><span class="o">)</span> <span class="o">{</span>
                            <span class="nx">urlValue</span> <span class="o">=</span> <span class="s1">'http:/'</span><span class="o">+</span><span class="s1">'/'</span> <span class="o">+</span> <span class="nx">urlValue</span><span class="o">;</span>
                        <span class="o">}</span>
                        
                    <span class="o">}</span>
                <span class="o">}</span>
                <span class="nx">el</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'href'</span><span class="o">,</span> <span class="nx">urlValue</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span><span class="nx">target</span><span class="o">.</span><span class="nx">checked</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nx">el</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'target'</span><span class="o">,</span> <span class="nx">target</span><span class="o">.</span><span class="nx">value</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="nx">el</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'target'</span><span class="o">,</span> <span class="s1">''</span><span class="o">);</span>
                <span class="o">}</span>
                <span class="nx">el</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'title'</span><span class="o">,</span> <span class="o">((</span><span class="nx">title</span><span class="o">.</span><span class="nx">value</span><span class="o">)</span> <span class="o">?</span> <span class="nx">title</span><span class="o">.</span><span class="nx">value</span> <span class="o">:</span> <span class="s1">''</span><span class="o">));</span>

            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="k">var</span> <span class="nx">_span</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_getDoc</span><span class="o">().</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'span'</span><span class="o">);</span>
                <span class="nx">_span</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">innerHTML</span><span class="o">;</span>
                <span class="nx">Dom</span><span class="o">.</span><span class="nx">addClass</span><span class="o">(</span><span class="nx">_span</span><span class="o">,</span> <span class="s1">'yui-non'</span><span class="o">);</span>
                <span class="nx">el</span><span class="o">.</span><span class="nx">parentNode</span><span class="o">.</span><span class="nx">replaceChild</span><span class="o">(</span><span class="nx">_span</span><span class="o">,</span> <span class="nx">el</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">nodeChange</span><span class="o">();</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span> <span class="o">=</span> <span class="o">[];</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @private</span>
<span class="c">        * @method _handleInsertImageClick</span>
<span class="c">        * @description Opens the Image Properties Window when the insert Image button is clicked or an Image is Double Clicked.</span>
<span class="c">        */</span>
        <span class="nx">_handleInsertImageClick</span><span class="o">:</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'limitCommands'</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(!</span><span class="k">this</span><span class="o">.</span><span class="nx">toolbar</span><span class="o">.</span><span class="nx">getButtonByValue</span><span class="o">(</span><span class="s1">'insertimage'</span><span class="o">))</span> <span class="o">{</span>
                    <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">'Toolbar Button for (insertimage) was not found, skipping exec.'</span><span class="o">,</span> <span class="s1">'info'</span><span class="o">,</span> <span class="s1">'Editor'</span><span class="o">);</span>
                    <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">_setBusy</span><span class="o">();</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">on</span><span class="o">(</span><span class="s1">'afterExecCommand'</span><span class="o">,</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">],</span>
                    <span class="nx">body</span> <span class="o">=</span> <span class="kc">null</span><span class="o">,</span>
                    <span class="nx">link</span> <span class="o">=</span> <span class="s1">''</span><span class="o">,</span>
                    <span class="nx">target</span> <span class="o">=</span> <span class="s1">''</span><span class="o">,</span>
                    <span class="nx">title</span> <span class="o">=</span> <span class="s1">''</span><span class="o">,</span>
                    <span class="nx">src</span> <span class="o">=</span> <span class="s1">''</span><span class="o">,</span>
                    <span class="nx">align</span> <span class="o">=</span> <span class="s1">''</span><span class="o">,</span>
                    <span class="nx">height</span> <span class="o">=</span> <span class="m">75</span><span class="o">,</span>
                    <span class="nx">width</span> <span class="o">=</span> <span class="m">75</span><span class="o">,</span>
                    <span class="nx">padding</span> <span class="o">=</span> <span class="m">0</span><span class="o">,</span>
                    <span class="nx">oheight</span> <span class="o">=</span> <span class="m">0</span><span class="o">,</span>
                    <span class="nx">owidth</span> <span class="o">=</span> <span class="m">0</span><span class="o">,</span>
                    <span class="nx">blankimage</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span>
                    <span class="nx">win</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">EditorWindow</span><span class="o">(</span><span class="s1">'insertimage'</span><span class="o">,</span> <span class="o">{</span>
                        <span class="nx">width</span><span class="o">:</span> <span class="s1">'415px'</span>
                    <span class="o">});</span>

                <span class="k">if</span> <span class="o">(!</span><span class="nx">el</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nx">el</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_getSelectedElement</span><span class="o">();</span>
                <span class="o">}</span>
                <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'src'</span><span class="o">))</span> <span class="o">{</span>
                        <span class="nx">src</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'src'</span><span class="o">,</span> <span class="m">2</span><span class="o">);</span>
                        <span class="k">if</span> <span class="o">(</span><span class="nx">src</span><span class="o">.</span><span class="nx">indexOf</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'blankimage'</span><span class="o">))</span> <span class="o">!=</span> <span class="o">-</span><span class="m">1</span><span class="o">)</span> <span class="o">{</span>
                            <span class="nx">src</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_IMAGE_HERE</span><span class="o">;</span>
                            <span class="nx">blankimage</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
                        <span class="o">}</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'alt'</span><span class="o">,</span> <span class="m">2</span><span class="o">))</span> <span class="o">{</span>
                        <span class="nx">title</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'alt'</span><span class="o">,</span> <span class="m">2</span><span class="o">);</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'title'</span><span class="o">,</span> <span class="m">2</span><span class="o">))</span> <span class="o">{</span>
                        <span class="nx">title</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'title'</span><span class="o">,</span> <span class="m">2</span><span class="o">);</span>
                    <span class="o">}</span>

                    <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">parentNode</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="o">.</span><span class="nx">_isElement</span><span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">parentNode</span><span class="o">,</span> <span class="s1">'a'</span><span class="o">))</span> <span class="o">{</span>
                        <span class="nx">link</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">parentNode</span><span class="o">.</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'href'</span><span class="o">,</span> <span class="m">2</span><span class="o">);</span>
                        <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">parentNode</span><span class="o">.</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'target'</span><span class="o">)</span> <span class="o">!==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                            <span class="nx">target</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">parentNode</span><span class="o">.</span><span class="nx">getAttribute</span><span class="o">(</span><span class="s1">'target'</span><span class="o">);</span>
                        <span class="o">}</span>
                    <span class="o">}</span>
                    <span class="nx">height</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">height</span><span class="o">,</span> <span class="m">10</span><span class="o">);</span>
                    <span class="nx">width</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">width</span><span class="o">,</span> <span class="m">10</span><span class="o">);</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">height</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">height</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">height</span><span class="o">,</span> <span class="m">10</span><span class="o">);</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">width</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">width</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">width</span><span class="o">,</span> <span class="m">10</span><span class="o">);</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">margin</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">padding</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">margin</span><span class="o">,</span> <span class="m">10</span><span class="o">);</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(!</span><span class="nx">el</span><span class="o">.</span><span class="nx">_height</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">el</span><span class="o">.</span><span class="nx">_height</span> <span class="o">=</span> <span class="nx">height</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(!</span><span class="nx">el</span><span class="o">.</span><span class="nx">_width</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">el</span><span class="o">.</span><span class="nx">_width</span> <span class="o">=</span> <span class="nx">width</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="nx">oheight</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">_height</span><span class="o">;</span>
                    <span class="nx">owidth</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">_width</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="k">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">'&lt;label for="insertimage_url"&gt;&lt;strong&gt;'</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_IMAGE_URL</span> <span class="o">+</span> <span class="s1">':&lt;/strong&gt; &lt;input type="text" id="insertimage_url" value="'</span> <span class="o">+</span> <span class="nx">src</span> <span class="o">+</span> <span class="s1">'" size="40"&gt;&lt;/label&gt;'</span><span class="o">;</span>
                <span class="nx">body</span> <span class="o">=</span> <span class="nb">document</span><span class="o">.</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'div'</span><span class="o">);</span>
                <span class="nx">body</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">str</span><span class="o">;</span>

                <span class="k">var</span> <span class="nx">tbarCont</span> <span class="o">=</span> <span class="nb">document</span><span class="o">.</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'div'</span><span class="o">);</span>
                <span class="nx">tbarCont</span><span class="o">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s1">'img_toolbar'</span><span class="o">;</span>
                <span class="nx">body</span><span class="o">.</span><span class="nx">appendChild</span><span class="o">(</span><span class="nx">tbarCont</span><span class="o">);</span>

                <span class="k">var</span> <span class="nx">str2</span> <span class="o">=</span> <span class="s1">'&lt;label for="insertimage_title"&gt;&lt;strong&gt;'</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_IMAGE_TITLE</span> <span class="o">+</span> <span class="s1">':&lt;/strong&gt; &lt;input type="text" id="insertimage_title" value="'</span> <span class="o">+</span> <span class="nx">title</span> <span class="o">+</span> <span class="s1">'" size="40"&gt;&lt;/label&gt;'</span><span class="o">;</span>
                <span class="nx">str2</span> <span class="o">+=</span> <span class="s1">'&lt;label for="insertimage_link"&gt;&lt;strong&gt;'</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_LINK_URL</span> <span class="o">+</span> <span class="s1">':&lt;/strong&gt; &lt;input type="text" name="insertimage_link" id="insertimage_link" value="'</span> <span class="o">+</span> <span class="nx">link</span> <span class="o">+</span> <span class="s1">'"&gt;&lt;/label&gt;'</span><span class="o">;</span>
                <span class="nx">str2</span> <span class="o">+=</span> <span class="s1">'&lt;label for="insertimage_target"&gt;&lt;strong&gt;&amp;nbsp;&lt;/strong&gt;&lt;input type="checkbox" name="insertimage_target_" id="insertimage_target" value="_blank"'</span> <span class="o">+</span> <span class="o">((</span><span class="nx">target</span><span class="o">)</span> <span class="o">?</span> <span class="s1">' checked'</span> <span class="o">:</span> <span class="s1">''</span><span class="o">)</span> <span class="o">+</span> <span class="s1">'&gt; '</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_LINK_NEW_WINDOW</span> <span class="o">+</span> <span class="s1">'&lt;/label&gt;'</span><span class="o">;</span>
                <span class="k">var</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="o">.</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'div'</span><span class="o">);</span>
                <span class="nx">div</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">str2</span><span class="o">;</span>
                <span class="nx">body</span><span class="o">.</span><span class="nx">appendChild</span><span class="o">(</span><span class="nx">div</span><span class="o">);</span>
                <span class="nx">win</span><span class="o">.</span><span class="nx">cache</span> <span class="o">=</span> <span class="nx">body</span><span class="o">;</span>

                <span class="k">var</span> <span class="nx">tbar</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">Toolbar</span><span class="o">(</span><span class="nx">tbarCont</span><span class="o">,</span> <span class="o">{</span>
                    <span class="c">/* {{{ */</span> 
                    <span class="nx">buttonType</span><span class="o">:</span> <span class="k">this</span><span class="o">.</span><span class="nx">_defaultToolbar</span><span class="o">.</span><span class="nx">buttonType</span><span class="o">,</span>
                    <span class="nx">buttons</span><span class="o">:</span> <span class="o">[</span>
                        <span class="o">{</span> <span class="nx">group</span><span class="o">:</span> <span class="s1">'textflow'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_IMAGE_TEXTFLOW</span> <span class="o">+</span> <span class="s1">':'</span><span class="o">,</span>
                            <span class="nx">buttons</span><span class="o">:</span> <span class="o">[</span>
                                <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Left'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'left'</span> <span class="o">},</span>
                                <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Inline'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'inline'</span> <span class="o">},</span>
                                <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Block'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'block'</span> <span class="o">},</span>
                                <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'push'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Right'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'right'</span> <span class="o">}</span>
                            <span class="o">]</span>
                        <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'separator'</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">group</span><span class="o">:</span> <span class="s1">'padding'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_IMAGE_PADDING</span> <span class="o">+</span> <span class="s1">':'</span><span class="o">,</span>
                            <span class="nx">buttons</span><span class="o">:</span> <span class="o">[</span>
                                <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'spin'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">''</span><span class="o">+</span><span class="nx">padding</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'padding'</span><span class="o">,</span> <span class="nx">range</span><span class="o">:</span> <span class="o">[</span><span class="m">0</span><span class="o">,</span> <span class="m">50</span><span class="o">]</span> <span class="o">}</span>
                            <span class="o">]</span>
                        <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'separator'</span> <span class="o">},</span>
                        <span class="o">{</span> <span class="nx">group</span><span class="o">:</span> <span class="s1">'border'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_IMAGE_BORDER</span> <span class="o">+</span> <span class="s1">':'</span><span class="o">,</span>
                            <span class="nx">buttons</span><span class="o">:</span> <span class="o">[</span>
                                <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'select'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Border Size'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'bordersize'</span><span class="o">,</span>
                                    <span class="nx">menu</span><span class="o">:</span> <span class="o">[</span>
                                        <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'none'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'0'</span><span class="o">,</span> <span class="nx">checked</span><span class="o">:</span> <span class="kc">true</span> <span class="o">},</span>
                                        <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'1px'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'1'</span> <span class="o">},</span>
                                        <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'2px'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'2'</span> <span class="o">},</span>
                                        <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'3px'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'3'</span> <span class="o">},</span>
                                        <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'4px'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'4'</span> <span class="o">},</span>
                                        <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'5px'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'5'</span> <span class="o">}</span>
                                    <span class="o">]</span>
                                <span class="o">},</span>
                                <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'select'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Border Type'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'bordertype'</span><span class="o">,</span> <span class="nx">disabled</span><span class="o">:</span> <span class="kc">true</span><span class="o">,</span>
                                    <span class="nx">menu</span><span class="o">:</span> <span class="o">[</span>
                                        <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Solid'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'solid'</span><span class="o">,</span> <span class="nx">checked</span><span class="o">:</span> <span class="kc">true</span> <span class="o">},</span>
                                        <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Dashed'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'dashed'</span> <span class="o">},</span>
                                        <span class="o">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">'Dotted'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'dotted'</span> <span class="o">}</span>
                                    <span class="o">]</span>
                                <span class="o">},</span>
                                <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'color'</span><span class="o">,</span> <span class="k">label</span><span class="o">:</span> <span class="s1">'Border Color'</span><span class="o">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">'bordercolor'</span><span class="o">,</span> <span class="nx">disabled</span><span class="o">:</span> <span class="kc">true</span> <span class="o">}</span>
                            <span class="o">]</span>
                        <span class="o">}</span>
                    <span class="o">]</span>
                    <span class="c">/* }}} */</span>
                <span class="o">});</span>
                
                <span class="k">var</span> <span class="nx">bsize</span> <span class="o">=</span> <span class="s1">'0'</span><span class="o">;</span>
                <span class="k">var</span> <span class="nx">btype</span> <span class="o">=</span> <span class="s1">'solid'</span><span class="o">;</span>
                <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderLeftWidth</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nx">bsize</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderLeftWidth</span><span class="o">,</span> <span class="m">10</span><span class="o">);</span>
                <span class="o">}</span>
                <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderLeftStyle</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nx">btype</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderLeftStyle</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="k">var</span> <span class="nx">bs_button</span> <span class="o">=</span> <span class="nx">tbar</span><span class="o">.</span><span class="nx">getButtonByValue</span><span class="o">(</span><span class="s1">'bordersize'</span><span class="o">);</span>
                <span class="k">var</span> <span class="nx">bSizeStr</span> <span class="o">=</span> <span class="o">((</span><span class="nb">parseInt</span><span class="o">(</span><span class="nx">bsize</span><span class="o">,</span> <span class="m">10</span><span class="o">)</span> <span class="o">&gt;</span> <span class="m">0</span><span class="o">)</span> <span class="o">?</span> <span class="s1">''</span> <span class="o">:</span> <span class="s1">'none'</span><span class="o">);</span>
                <span class="nx">bs_button</span><span class="o">.</span><span class="nx">set</span><span class="o">(</span><span class="s1">'label'</span><span class="o">,</span> <span class="s1">'&lt;span class="yui-toolbar-bordersize-'</span> <span class="o">+</span> <span class="nx">bsize</span> <span class="o">+</span> <span class="s1">'"&gt;'</span><span class="o">+</span><span class="nx">bSizeStr</span><span class="o">+</span><span class="s1">'&lt;/span&gt;'</span><span class="o">);</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">_updateMenuChecked</span><span class="o">(</span><span class="s1">'bordersize'</span><span class="o">,</span> <span class="nx">bsize</span><span class="o">,</span> <span class="nx">tbar</span><span class="o">);</span>

                <span class="k">var</span> <span class="nx">bt_button</span> <span class="o">=</span> <span class="nx">tbar</span><span class="o">.</span><span class="nx">getButtonByValue</span><span class="o">(</span><span class="s1">'bordertype'</span><span class="o">);</span>
                <span class="nx">bt_button</span><span class="o">.</span><span class="nx">set</span><span class="o">(</span><span class="s1">'label'</span><span class="o">,</span> <span class="s1">'&lt;span class="yui-toolbar-bordertype-'</span> <span class="o">+</span> <span class="nx">btype</span> <span class="o">+</span> <span class="s1">'"&gt;&lt;/span&gt;'</span><span class="o">);</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">_updateMenuChecked</span><span class="o">(</span><span class="s1">'bordertype'</span><span class="o">,</span> <span class="nx">btype</span><span class="o">,</span> <span class="nx">tbar</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span><span class="nb">parseInt</span><span class="o">(</span><span class="nx">bsize</span><span class="o">,</span> <span class="m">10</span><span class="o">)</span> <span class="o">&gt;</span> <span class="m">0</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nx">tbar</span><span class="o">.</span><span class="nx">enableButton</span><span class="o">(</span><span class="nx">bt_button</span><span class="o">);</span>
                    <span class="nx">tbar</span><span class="o">.</span><span class="nx">enableButton</span><span class="o">(</span><span class="nx">bs_button</span><span class="o">);</span>
                <span class="o">}</span>

                <span class="k">var</span> <span class="nx">cont</span> <span class="o">=</span> <span class="nx">tbar</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'cont'</span><span class="o">);</span>
                <span class="k">var</span> <span class="nx">hw</span> <span class="o">=</span> <span class="nb">document</span><span class="o">.</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'div'</span><span class="o">);</span>
                <span class="nx">hw</span><span class="o">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">'yui-toolbar-group yui-toolbar-group-height-width height-width'</span><span class="o">;</span>
                <span class="nx">hw</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'&lt;h3&gt;'</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_IMAGE_SIZE</span> <span class="o">+</span> <span class="s1">':&lt;/h3&gt;'</span><span class="o">;</span>
                <span class="k">var</span> <span class="nx">orgSize</span> <span class="o">=</span> <span class="s1">''</span><span class="o">;</span>
                <span class="k">if</span> <span class="o">((</span><span class="nx">height</span> <span class="o">!=</span> <span class="nx">oheight</span><span class="o">)</span> <span class="o">||</span> <span class="o">(</span><span class="nx">width</span> <span class="o">!=</span> <span class="nx">owidth</span><span class="o">))</span> <span class="o">{</span>
                    <span class="nx">orgSize</span> <span class="o">=</span> <span class="s1">'&lt;span class="info"&gt;'</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_IMAGE_ORIG_SIZE</span> <span class="o">+</span> <span class="s1">'&lt;br&gt;'</span><span class="o">+</span> <span class="nx">owidth</span> <span class="o">+</span><span class="s1">' x '</span> <span class="o">+</span> <span class="nx">oheight</span> <span class="o">+</span> <span class="s1">'&lt;/span&gt;'</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="nx">hw</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">+=</span> <span class="s1">'&lt;span&gt;&lt;input type="text" size="3" value="'</span><span class="o">+</span><span class="nx">width</span><span class="o">+</span><span class="s1">'" id="insertimage_width"&gt; x &lt;input type="text" size="3" value="'</span><span class="o">+</span><span class="nx">height</span><span class="o">+</span><span class="s1">'" id="insertimage_height"&gt;&lt;/span&gt;'</span> <span class="o">+</span> <span class="nx">orgSize</span><span class="o">;</span>
                <span class="nx">cont</span><span class="o">.</span><span class="nx">insertBefore</span><span class="o">(</span><span class="nx">hw</span><span class="o">,</span> <span class="nx">cont</span><span class="o">.</span><span class="nx">firstChild</span><span class="o">);</span>

                <span class="nx">Event</span><span class="o">.</span><span class="nx">onAvailable</span><span class="o">(</span><span class="s1">'insertimage_width'</span><span class="o">,</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                    <span class="nx">Event</span><span class="o">.</span><span class="nx">on</span><span class="o">(</span><span class="s1">'insertimage_width'</span><span class="o">,</span> <span class="s1">'blur'</span><span class="o">,</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                        <span class="k">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="o">(</span><span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'insertimage_width'</span><span class="o">).</span><span class="nx">value</span><span class="o">,</span> <span class="m">10</span><span class="o">);</span>
                        <span class="k">if</span> <span class="o">(</span><span class="nx">value</span> <span class="o">&gt;</span> <span class="m">5</span><span class="o">)</span> <span class="o">{</span>
                            <span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">value</span> <span class="o">+</span> <span class="s1">'px'</span><span class="o">;</span>
                            <span class="k">this</span><span class="o">.</span><span class="nx">moveWindow</span><span class="o">();</span>
                        <span class="o">}</span>
                    <span class="o">},</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
                <span class="o">},</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
                <span class="nx">Event</span><span class="o">.</span><span class="nx">onAvailable</span><span class="o">(</span><span class="s1">'insertimage_height'</span><span class="o">,</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                    <span class="nx">Event</span><span class="o">.</span><span class="nx">on</span><span class="o">(</span><span class="s1">'insertimage_height'</span><span class="o">,</span> <span class="s1">'blur'</span><span class="o">,</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                        <span class="k">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="o">(</span><span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'insertimage_height'</span><span class="o">).</span><span class="nx">value</span><span class="o">,</span> <span class="m">10</span><span class="o">);</span>
                        <span class="k">if</span> <span class="o">(</span><span class="nx">value</span> <span class="o">&gt;</span> <span class="m">5</span><span class="o">)</span> <span class="o">{</span>
                            <span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">value</span> <span class="o">+</span> <span class="s1">'px'</span><span class="o">;</span>
                            <span class="k">this</span><span class="o">.</span><span class="nx">moveWindow</span><span class="o">();</span>
                        <span class="o">}</span>
                    <span class="o">},</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
                <span class="o">},</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>

                <span class="k">if</span> <span class="o">((</span><span class="nx">el</span><span class="o">.</span><span class="nx">align</span> <span class="o">==</span> <span class="s1">'right'</span><span class="o">)</span> <span class="o">||</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">align</span> <span class="o">==</span> <span class="s1">'left'</span><span class="o">))</span> <span class="o">{</span>
                    <span class="nx">tbar</span><span class="o">.</span><span class="nx">selectButton</span><span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">align</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">display</span> <span class="o">==</span> <span class="s1">'block'</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nx">tbar</span><span class="o">.</span><span class="nx">selectButton</span><span class="o">(</span><span class="s1">'block'</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="nx">tbar</span><span class="o">.</span><span class="nx">selectButton</span><span class="o">(</span><span class="s1">'inline'</span><span class="o">);</span>
                <span class="o">}</span>
                <span class="k">if</span> <span class="o">(</span><span class="nb">parseInt</span><span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">marginLeft</span><span class="o">,</span> <span class="m">10</span><span class="o">)</span> <span class="o">&gt;</span> <span class="m">0</span><span class="o">)</span> <span class="o">{</span>
                     <span class="nx">tbar</span><span class="o">.</span><span class="nx">getButtonByValue</span><span class="o">(</span><span class="s1">'padding'</span><span class="o">).</span><span class="nx">set</span><span class="o">(</span><span class="s1">'label'</span><span class="o">,</span> <span class="s1">''</span><span class="o">+</span><span class="nb">parseInt</span><span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">marginLeft</span><span class="o">,</span> <span class="m">10</span><span class="o">));</span>
                <span class="o">}</span>
                <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderSize</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nx">tbar</span><span class="o">.</span><span class="nx">selectButton</span><span class="o">(</span><span class="s1">'bordersize'</span><span class="o">);</span>
                    <span class="nx">tbar</span><span class="o">.</span><span class="nx">selectButton</span><span class="o">(</span><span class="nb">parseInt</span><span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderSize</span><span class="o">,</span> <span class="m">10</span><span class="o">));</span>
                <span class="o">}</span>

                <span class="nx">tbar</span><span class="o">.</span><span class="nx">on</span><span class="o">(</span><span class="s1">'colorPickerClicked'</span><span class="o">,</span> <span class="k">function</span><span class="o">(</span><span class="nx">o</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">var</span> <span class="nx">size</span> <span class="o">=</span> <span class="s1">'1'</span><span class="o">,</span> <span class="nx">type</span> <span class="o">=</span> <span class="s1">'solid'</span><span class="o">,</span> <span class="nx">color</span> <span class="o">=</span> <span class="s1">'black'</span><span class="o">;</span>

                    <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderLeftWidth</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">size</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderLeftWidth</span><span class="o">,</span> <span class="m">10</span><span class="o">);</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderLeftStyle</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">type</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderLeftStyle</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderLeftColor</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">color</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderLeftColor</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="k">var</span> <span class="nx">borderString</span> <span class="o">=</span> <span class="nx">size</span> <span class="o">+</span> <span class="s1">'px '</span> <span class="o">+</span> <span class="nx">type</span> <span class="o">+</span> <span class="s1">' #'</span> <span class="o">+</span> <span class="nx">o</span><span class="o">.</span><span class="nx">color</span><span class="o">;</span>
                    <span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">border</span> <span class="o">=</span> <span class="nx">borderString</span><span class="o">;</span>
                <span class="o">},</span> <span class="k">this</span><span class="o">.</span><span class="nx">toolbar</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>

                <span class="nx">tbar</span><span class="o">.</span><span class="nx">on</span><span class="o">(</span><span class="s1">'buttonClick'</span><span class="o">,</span> <span class="k">function</span><span class="o">(</span><span class="nx">o</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">o</span><span class="o">.</span><span class="nx">button</span><span class="o">.</span><span class="nx">value</span><span class="o">,</span>
                        <span class="nx">borderString</span> <span class="o">=</span> <span class="s1">''</span><span class="o">;</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">o</span><span class="o">.</span><span class="nx">button</span><span class="o">.</span><span class="nx">menucmd</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">value</span> <span class="o">=</span> <span class="nx">o</span><span class="o">.</span><span class="nx">button</span><span class="o">.</span><span class="nx">menucmd</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="k">var</span> <span class="nx">size</span> <span class="o">=</span> <span class="s1">'1'</span><span class="o">,</span> <span class="nx">type</span> <span class="o">=</span> <span class="s1">'solid'</span><span class="o">,</span> <span class="nx">color</span> <span class="o">=</span> <span class="s1">'black'</span><span class="o">;</span>

                    <span class="c">/* All border calcs are done on the left border</span>
<span class="c">                        since our default interface only supports</span>
<span class="c">                        one border size/type and color */</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderLeftWidth</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">size</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderLeftWidth</span><span class="o">,</span> <span class="m">10</span><span class="o">);</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderLeftStyle</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">type</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderLeftStyle</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderLeftColor</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">color</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">borderLeftColor</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="nx">switch</span><span class="o">(</span><span class="nx">value</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">case</span> <span class="s1">'bordersize'</span><span class="o">:</span>
                            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">webkit</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="o">.</span><span class="nx">_lastImage</span><span class="o">)</span> <span class="o">{</span>
                                <span class="nx">Dom</span><span class="o">.</span><span class="nx">removeClass</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_lastImage</span><span class="o">,</span> <span class="s1">'selected'</span><span class="o">);</span>
                                <span class="k">this</span><span class="o">.</span><span class="nx">_lastImage</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
                            <span class="o">}</span>

                            <span class="nx">borderString</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="o">(</span><span class="nx">o</span><span class="o">.</span><span class="nx">button</span><span class="o">.</span><span class="nx">value</span><span class="o">,</span> <span class="m">10</span><span class="o">)</span> <span class="o">+</span> <span class="s1">'px '</span> <span class="o">+</span> <span class="nx">type</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="nx">color</span><span class="o">;</span>
                            <span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">border</span> <span class="o">=</span> <span class="nx">borderString</span><span class="o">;</span>
                            <span class="k">if</span> <span class="o">(</span><span class="nb">parseInt</span><span class="o">(</span><span class="nx">o</span><span class="o">.</span><span class="nx">button</span><span class="o">.</span><span class="nx">value</span><span class="o">,</span> <span class="m">10</span><span class="o">)</span> <span class="o">&gt;</span> <span class="m">0</span><span class="o">)</span> <span class="o">{</span>
                                <span class="nx">tbar</span><span class="o">.</span><span class="nx">enableButton</span><span class="o">(</span><span class="s1">'bordertype'</span><span class="o">);</span>
                                <span class="nx">tbar</span><span class="o">.</span><span class="nx">enableButton</span><span class="o">(</span><span class="s1">'bordercolor'</span><span class="o">);</span>
                            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                                <span class="nx">tbar</span><span class="o">.</span><span class="nx">disableButton</span><span class="o">(</span><span class="s1">'bordertype'</span><span class="o">);</span>
                                <span class="nx">tbar</span><span class="o">.</span><span class="nx">disableButton</span><span class="o">(</span><span class="s1">'bordercolor'</span><span class="o">);</span>
                            <span class="o">}</span>
                            <span class="k">break</span><span class="o">;</span>
                        <span class="nx">case</span> <span class="s1">'bordertype'</span><span class="o">:</span>
                            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">webkit</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="o">.</span><span class="nx">_lastImage</span><span class="o">)</span> <span class="o">{</span>
                                <span class="nx">Dom</span><span class="o">.</span><span class="nx">removeClass</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_lastImage</span><span class="o">,</span> <span class="s1">'selected'</span><span class="o">);</span>
                                <span class="k">this</span><span class="o">.</span><span class="nx">_lastImage</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
                            <span class="o">}</span>
                            <span class="nx">borderString</span> <span class="o">=</span> <span class="nx">size</span> <span class="o">+</span> <span class="s1">'px '</span> <span class="o">+</span> <span class="nx">o</span><span class="o">.</span><span class="nx">button</span><span class="o">.</span><span class="nx">value</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="nx">color</span><span class="o">;</span>
                            <span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">border</span> <span class="o">=</span> <span class="nx">borderString</span><span class="o">;</span>
                            <span class="k">break</span><span class="o">;</span>
                        <span class="nx">case</span> <span class="s1">'right'</span><span class="o">:</span>
                        <span class="nx">case</span> <span class="s1">'left'</span><span class="o">:</span>
                            <span class="nx">tbar</span><span class="o">.</span><span class="nx">deselectAllButtons</span><span class="o">();</span>
                            <span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">''</span><span class="o">;</span>
                            <span class="nx">el</span><span class="o">.</span><span class="nx">align</span> <span class="o">=</span> <span class="nx">o</span><span class="o">.</span><span class="nx">button</span><span class="o">.</span><span class="nx">value</span><span class="o">;</span>
                            <span class="k">break</span><span class="o">;</span>
                        <span class="nx">case</span> <span class="s1">'inline'</span><span class="o">:</span>
                            <span class="nx">tbar</span><span class="o">.</span><span class="nx">deselectAllButtons</span><span class="o">();</span>
                            <span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">''</span><span class="o">;</span>
                            <span class="nx">el</span><span class="o">.</span><span class="nx">align</span> <span class="o">=</span> <span class="s1">''</span><span class="o">;</span>
                            <span class="k">break</span><span class="o">;</span>
                        <span class="nx">case</span> <span class="s1">'block'</span><span class="o">:</span>
                            <span class="nx">tbar</span><span class="o">.</span><span class="nx">deselectAllButtons</span><span class="o">();</span>
                            <span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">'block'</span><span class="o">;</span>
                            <span class="nx">el</span><span class="o">.</span><span class="nx">align</span> <span class="o">=</span> <span class="s1">'center'</span><span class="o">;</span>
                            <span class="k">break</span><span class="o">;</span>
                        <span class="nx">case</span> <span class="s1">'padding'</span><span class="o">:</span>
                            <span class="k">var</span> <span class="nx">_button</span> <span class="o">=</span> <span class="nx">tbar</span><span class="o">.</span><span class="nx">getButtonById</span><span class="o">(</span><span class="nx">o</span><span class="o">.</span><span class="nx">button</span><span class="o">.</span><span class="nx">id</span><span class="o">);</span>
                            <span class="nx">el</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">margin</span> <span class="o">=</span> <span class="nx">_button</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'label'</span><span class="o">)</span> <span class="o">+</span> <span class="s1">'px'</span><span class="o">;</span>
                            <span class="k">break</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="nx">tbar</span><span class="o">.</span><span class="nx">selectButton</span><span class="o">(</span><span class="nx">o</span><span class="o">.</span><span class="nx">button</span><span class="o">.</span><span class="nx">value</span><span class="o">);</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">moveWindow</span><span class="o">();</span>
                <span class="o">},</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>

                <span class="nx">win</span><span class="o">.</span><span class="nx">setHeader</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">STR_IMAGE_PROP_TITLE</span><span class="o">);</span>
                <span class="nx">win</span><span class="o">.</span><span class="nx">setBody</span><span class="o">(</span><span class="nx">body</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">((</span><span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">webkit</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">webkit3</span><span class="o">)</span> <span class="o">||</span> <span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">opera</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nx">win</span><span class="o">.</span><span class="nx">setFooter</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">STR_IMAGE_COPY</span><span class="o">);</span>
                <span class="o">}</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">openWindow</span><span class="o">(</span><span class="nx">win</span><span class="o">);</span>

                <span class="c">//Set event after openWindow..</span>
<span class="c"></span>                <span class="nx">Event</span><span class="o">.</span><span class="nx">onAvailable</span><span class="o">(</span><span class="s1">'insertimage_url'</span><span class="o">,</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>

                    <span class="k">this</span><span class="o">.</span><span class="nx">toolbar</span><span class="o">.</span><span class="nx">selectButton</span><span class="o">(</span><span class="s1">'insertimage'</span><span class="o">);</span>

                    <span class="nb">window</span><span class="o">.</span><span class="nx">setTimeout</span><span class="o">(</span><span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                        <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'insertimage_url'</span><span class="o">).</span><span class="nx">focus</span><span class="o">();</span>
                        <span class="k">if</span> <span class="o">(</span><span class="nx">blankimage</span><span class="o">)</span> <span class="o">{</span>
                            <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'insertimage_url'</span><span class="o">).</span><span class="nx">select</span><span class="o">();</span>
                        <span class="o">}</span>
                    <span class="o">},</span> <span class="m">50</span><span class="o">);</span>
                    
                    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'localFileWarning'</span><span class="o">))</span> <span class="o">{</span>
                        <span class="nx">Event</span><span class="o">.</span><span class="nx">on</span><span class="o">(</span><span class="s1">'insertimage_link'</span><span class="o">,</span> <span class="s1">'blur'</span><span class="o">,</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                            <span class="k">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'insertimage_link'</span><span class="o">);</span>
                            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_isLocalFile</span><span class="o">(</span><span class="nx">url</span><span class="o">.</span><span class="nx">value</span><span class="o">))</span> <span class="o">{</span>
                                <span class="c">//Local File throw Warning</span>
<span class="c"></span>                                <span class="nx">Dom</span><span class="o">.</span><span class="nx">addClass</span><span class="o">(</span><span class="nx">url</span><span class="o">,</span> <span class="s1">'warning'</span><span class="o">);</span>
                                <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">'Local file reference found, show local warning'</span><span class="o">,</span> <span class="s1">'warn'</span><span class="o">,</span> <span class="s1">'Editor'</span><span class="o">);</span>
                                <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">setFooter</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">STR_LOCAL_FILE_WARNING</span><span class="o">);</span>
                            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                                <span class="nx">Dom</span><span class="o">.</span><span class="nx">removeClass</span><span class="o">(</span><span class="nx">url</span><span class="o">,</span> <span class="s1">'warning'</span><span class="o">);</span>
                                <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">setFooter</span><span class="o">(</span><span class="s1">' '</span><span class="o">);</span>
                                <span class="k">if</span> <span class="o">((</span><span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">webkit</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">webkit3</span><span class="o">)</span> <span class="o">||</span> <span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">opera</span><span class="o">)</span> <span class="o">{</span>
                                    <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">setFooter</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">STR_IMAGE_COPY</span><span class="o">);</span>
                                <span class="o">}</span>
                            <span class="o">}</span>
                        <span class="o">},</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>

                        <span class="nx">Event</span><span class="o">.</span><span class="nx">on</span><span class="o">(</span><span class="s1">'insertimage_url'</span><span class="o">,</span> <span class="s1">'blur'</span><span class="o">,</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                            <span class="k">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'insertimage_url'</span><span class="o">);</span>
                            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_isLocalFile</span><span class="o">(</span><span class="nx">url</span><span class="o">.</span><span class="nx">value</span><span class="o">))</span> <span class="o">{</span>
                                <span class="c">//Local File throw Warning</span>
<span class="c"></span>                                <span class="nx">Dom</span><span class="o">.</span><span class="nx">addClass</span><span class="o">(</span><span class="nx">url</span><span class="o">,</span> <span class="s1">'warning'</span><span class="o">);</span>
                                <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">'Local file reference found, show local warning'</span><span class="o">,</span> <span class="s1">'warn'</span><span class="o">,</span> <span class="s1">'Editor'</span><span class="o">);</span>
                                <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">setFooter</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">STR_LOCAL_FILE_WARNING</span><span class="o">);</span>
                            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">])</span> <span class="o">{</span>
                                <span class="nx">Dom</span><span class="o">.</span><span class="nx">removeClass</span><span class="o">(</span><span class="nx">url</span><span class="o">,</span> <span class="s1">'warning'</span><span class="o">);</span>
                                <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">setFooter</span><span class="o">(</span><span class="s1">' '</span><span class="o">);</span>
                                <span class="k">if</span> <span class="o">((</span><span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">webkit</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">webkit3</span><span class="o">)</span> <span class="o">||</span> <span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">opera</span><span class="o">)</span> <span class="o">{</span>
                                    <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">setFooter</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">STR_IMAGE_COPY</span><span class="o">);</span>
                                <span class="o">}</span>
                                
                                <span class="k">if</span> <span class="o">(</span><span class="nx">url</span> <span class="o">&amp;&amp;</span> <span class="nx">url</span><span class="o">.</span><span class="nx">value</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="nx">url</span><span class="o">.</span><span class="nx">value</span> <span class="o">!=</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_IMAGE_HERE</span><span class="o">))</span> <span class="o">{</span>
                                    <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">].</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'src'</span><span class="o">,</span> <span class="nx">url</span><span class="o">.</span><span class="nx">value</span><span class="o">);</span>
                                    <span class="k">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="o">,</span>
                                        <span class="nx">img</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Image</span><span class="o">();</span>

                                    <span class="nx">img</span><span class="o">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                                        <span class="nx">url</span><span class="o">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">self</span><span class="o">.</span><span class="nx">STR_IMAGE_HERE</span><span class="o">;</span>
                                        <span class="nx">img</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'src'</span><span class="o">,</span> <span class="nx">self</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'blankimage'</span><span class="o">));</span>
                                        <span class="nx">self</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">].</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'src'</span><span class="o">,</span> <span class="nx">self</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'blankimage'</span><span class="o">));</span>
                                        <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'insertimage_height'</span><span class="o">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">img</span><span class="o">.</span><span class="nx">height</span><span class="o">;</span>
                                        <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'insertimage_width'</span><span class="o">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">img</span><span class="o">.</span><span class="nx">width</span><span class="o">;</span>
                                    <span class="o">};</span>
                                    <span class="nb">window</span><span class="o">.</span><span class="nx">setTimeout</span><span class="o">(</span><span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                                        <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'insertimage_height'</span><span class="o">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">img</span><span class="o">.</span><span class="nx">height</span><span class="o">;</span>
                                        <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'insertimage_width'</span><span class="o">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">img</span><span class="o">.</span><span class="nx">width</span><span class="o">;</span>
                                        <span class="k">if</span> <span class="o">(</span><span class="nx">self</span><span class="o">.</span><span class="nx">currentElement</span> <span class="o">&amp;&amp;</span> <span class="nx">self</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">])</span> <span class="o">{</span>
                                            <span class="k">if</span> <span class="o">(!</span><span class="nx">self</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">].</span><span class="nx">_height</span><span class="o">)</span> <span class="o">{</span>
                                                <span class="nx">self</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">].</span><span class="nx">_height</span> <span class="o">=</span> <span class="nx">img</span><span class="o">.</span><span class="nx">height</span><span class="o">;</span>
                                            <span class="o">}</span>
                                            <span class="k">if</span> <span class="o">(!</span><span class="nx">self</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">].</span><span class="nx">_width</span><span class="o">)</span> <span class="o">{</span>
                                                <span class="nx">self</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">].</span><span class="nx">_width</span> <span class="o">=</span> <span class="nx">img</span><span class="o">.</span><span class="nx">width</span><span class="o">;</span>
                                            <span class="o">}</span>
                                        <span class="o">}</span>
                                        <span class="nx">self</span><span class="o">.</span><span class="nx">moveWindow</span><span class="o">();</span>
                                    <span class="o">},</span> <span class="m">200</span><span class="o">);</span>

                                    <span class="k">if</span> <span class="o">(</span><span class="nx">url</span><span class="o">.</span><span class="nx">value</span> <span class="o">!=</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_IMAGE_HERE</span><span class="o">)</span> <span class="o">{</span>
                                        <span class="nx">img</span><span class="o">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">url</span><span class="o">.</span><span class="nx">value</span><span class="o">;</span>
                                    <span class="o">}</span>
                                <span class="o">}</span>
                            <span class="o">}</span>
                        <span class="o">},</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">},</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
            <span class="o">});</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @private</span>
<span class="c">        * @method _handleInsertImageWindowClose</span>
<span class="c">        * @description Handles the closing of the Image Properties Window.</span>
<span class="c">        */</span>
        <span class="nx">_handleInsertImageWindowClose</span><span class="o">:</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'insertimage_url'</span><span class="o">);</span>
            <span class="k">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'insertimage_title'</span><span class="o">);</span>
            <span class="k">var</span> <span class="nx">link</span> <span class="o">=</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'insertimage_link'</span><span class="o">);</span>
            <span class="k">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'insertimage_target'</span><span class="o">);</span>
            <span class="k">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">];</span>
            <span class="k">if</span> <span class="o">(</span><span class="nx">url</span> <span class="o">&amp;&amp;</span> <span class="nx">url</span><span class="o">.</span><span class="nx">value</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="nx">url</span><span class="o">.</span><span class="nx">value</span> <span class="o">!=</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_IMAGE_HERE</span><span class="o">))</span> <span class="o">{</span>
                <span class="nx">el</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'src'</span><span class="o">,</span> <span class="nx">url</span><span class="o">.</span><span class="nx">value</span><span class="o">);</span>
                <span class="nx">el</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'title'</span><span class="o">,</span> <span class="nx">title</span><span class="o">.</span><span class="nx">value</span><span class="o">);</span>
                <span class="nx">el</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'alt'</span><span class="o">,</span> <span class="nx">title</span><span class="o">.</span><span class="nx">value</span><span class="o">);</span>
                <span class="k">var</span> <span class="nx">par</span> <span class="o">=</span> <span class="nx">el</span><span class="o">.</span><span class="nx">parentNode</span><span class="o">;</span>
                <span class="k">if</span> <span class="o">(</span><span class="nx">link</span><span class="o">.</span><span class="nx">value</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">var</span> <span class="nx">urlValue</span> <span class="o">=</span> <span class="nx">link</span><span class="o">.</span><span class="nx">value</span><span class="o">;</span>
                    <span class="k">if</span> <span class="o">((</span><span class="nx">urlValue</span><span class="o">.</span><span class="nx">indexOf</span><span class="o">(</span><span class="s1">':/'</span><span class="o">+</span><span class="s1">'/'</span><span class="o">)</span> <span class="o">==</span> <span class="o">-</span><span class="m">1</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="nx">urlValue</span><span class="o">.</span><span class="nx">substring</span><span class="o">(</span><span class="m">0</span><span class="o">,</span><span class="m">1</span><span class="o">)</span> <span class="o">!=</span> <span class="s1">'/'</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="nx">urlValue</span><span class="o">.</span><span class="nx">substring</span><span class="o">(</span><span class="m">0</span><span class="o">,</span> <span class="m">6</span><span class="o">).</span><span class="nx">toLowerCase</span><span class="o">()</span> <span class="o">!=</span> <span class="s1">'mailto'</span><span class="o">))</span> <span class="o">{</span>
                        <span class="k">if</span> <span class="o">((</span><span class="nx">urlValue</span><span class="o">.</span><span class="nx">indexOf</span><span class="o">(</span><span class="s1">'@'</span><span class="o">)</span> <span class="o">!=</span> <span class="o">-</span><span class="m">1</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="nx">urlValue</span><span class="o">.</span><span class="nx">substring</span><span class="o">(</span><span class="m">0</span><span class="o">,</span> <span class="m">6</span><span class="o">).</span><span class="nx">toLowerCase</span><span class="o">()</span> <span class="o">!=</span> <span class="s1">'mailto'</span><span class="o">))</span> <span class="o">{</span>
                            <span class="c">//Found an @ sign, prefix with mailto:</span>
<span class="c"></span>                            <span class="nx">urlValue</span> <span class="o">=</span> <span class="s1">'mailto:'</span> <span class="o">+</span> <span class="nx">urlValue</span><span class="o">;</span>
                        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                            <span class="c">/* :// not found adding */</span>
                            <span class="nx">urlValue</span> <span class="o">=</span> <span class="s1">'http:/'</span><span class="o">+</span><span class="s1">'/'</span> <span class="o">+</span> <span class="nx">urlValue</span><span class="o">;</span>
                        <span class="o">}</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">par</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="o">.</span><span class="nx">_isElement</span><span class="o">(</span><span class="nx">par</span><span class="o">,</span> <span class="s1">'a'</span><span class="o">))</span> <span class="o">{</span>
                        <span class="nx">par</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'href'</span><span class="o">,</span> <span class="nx">urlValue</span><span class="o">);</span>
                        <span class="k">if</span> <span class="o">(</span><span class="nx">target</span><span class="o">.</span><span class="nx">checked</span><span class="o">)</span> <span class="o">{</span>
                            <span class="nx">par</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'target'</span><span class="o">,</span> <span class="nx">target</span><span class="o">.</span><span class="nx">value</span><span class="o">);</span>
                        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                            <span class="nx">par</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'target'</span><span class="o">,</span> <span class="s1">''</span><span class="o">);</span>
                        <span class="o">}</span>
                    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                        <span class="k">var</span> <span class="nx">_a</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_getDoc</span><span class="o">().</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'a'</span><span class="o">);</span>
                        <span class="nx">_a</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'href'</span><span class="o">,</span> <span class="nx">urlValue</span><span class="o">);</span>
                        <span class="k">if</span> <span class="o">(</span><span class="nx">target</span><span class="o">.</span><span class="nx">checked</span><span class="o">)</span> <span class="o">{</span>
                            <span class="nx">_a</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'target'</span><span class="o">,</span> <span class="nx">target</span><span class="o">.</span><span class="nx">value</span><span class="o">);</span>
                        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                            <span class="nx">_a</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'target'</span><span class="o">,</span> <span class="s1">''</span><span class="o">);</span>
                        <span class="o">}</span>
                        <span class="nx">el</span><span class="o">.</span><span class="nx">parentNode</span><span class="o">.</span><span class="nx">replaceChild</span><span class="o">(</span><span class="nx">_a</span><span class="o">,</span> <span class="nx">el</span><span class="o">);</span>
                        <span class="nx">_a</span><span class="o">.</span><span class="nx">appendChild</span><span class="o">(</span><span class="nx">el</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">par</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="o">.</span><span class="nx">_isElement</span><span class="o">(</span><span class="nx">par</span><span class="o">,</span> <span class="s1">'a'</span><span class="o">))</span> <span class="o">{</span>
                        <span class="nx">par</span><span class="o">.</span><span class="nx">parentNode</span><span class="o">.</span><span class="nx">replaceChild</span><span class="o">(</span><span class="nx">el</span><span class="o">,</span> <span class="nx">par</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="c">//No url/src given, remove the node from the document</span>
<span class="c"></span>                <span class="nx">el</span><span class="o">.</span><span class="nx">parentNode</span><span class="o">.</span><span class="nx">removeChild</span><span class="o">(</span><span class="nx">el</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span> <span class="o">=</span> <span class="o">[];</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">nodeChange</span><span class="o">();</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @private</span>
<span class="c">        * @method _renderPanel</span>
<span class="c">        * @description Renders the panel used for Editor Windows to the document so we can start using it..</span>
<span class="c">        * @returns {&lt;a href="YAHOO.widget.Overlay.html"&gt;YAHOO.widget.Overlay&lt;/a&gt;}</span>
<span class="c">        */</span>
        <span class="nx">_renderPanel</span><span class="o">:</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">var</span> <span class="nx">panel</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(!</span><span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">EditorInfo</span><span class="o">.</span><span class="nx">panel</span><span class="o">)</span> <span class="o">{</span>
                <span class="nx">panel</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">Overlay</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">EDITOR_PANEL_ID</span><span class="o">,</span> <span class="o">{</span>
                    <span class="nx">width</span><span class="o">:</span> <span class="s1">'300px'</span><span class="o">,</span>
                    <span class="nx">iframe</span><span class="o">:</span> <span class="kc">true</span><span class="o">,</span>
                    <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span><span class="o">,</span>
                    <span class="nx">underlay</span><span class="o">:</span> <span class="s1">'none'</span><span class="o">,</span>
                    <span class="nx">draggable</span><span class="o">:</span> <span class="kc">false</span><span class="o">,</span>
                    <span class="nx">close</span><span class="o">:</span> <span class="kc">false</span>
                <span class="o">});</span>
                <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">EditorInfo</span><span class="o">.</span><span class="nx">panel</span> <span class="o">=</span> <span class="nx">panel</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="nx">panel</span> <span class="o">=</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">EditorInfo</span><span class="o">.</span><span class="nx">panel</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">set</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">,</span> <span class="nx">panel</span><span class="o">);</span>

            <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">setBody</span><span class="o">(</span><span class="s1">'---'</span><span class="o">);</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">setHeader</span><span class="o">(</span><span class="s1">' '</span><span class="o">);</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">setFooter</span><span class="o">(</span><span class="s1">' '</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">DOMReady</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">render</span><span class="o">(</span><span class="nb">document</span><span class="o">.</span><span class="nx">body</span><span class="o">);</span>
                <span class="nx">Dom</span><span class="o">.</span><span class="nx">addClass</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">element</span><span class="o">,</span> <span class="s1">'yui-editor-panel'</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="nx">Event</span><span class="o">.</span><span class="nx">onDOMReady</span><span class="o">(</span><span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">render</span><span class="o">(</span><span class="nb">document</span><span class="o">.</span><span class="nx">body</span><span class="o">);</span>
                    <span class="nx">Dom</span><span class="o">.</span><span class="nx">addClass</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">element</span><span class="o">,</span> <span class="s1">'yui-editor-panel'</span><span class="o">);</span>
                <span class="o">},</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">showEvent</span><span class="o">.</span><span class="nx">subscribe</span><span class="o">(</span><span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Dom</span><span class="o">.</span><span class="nx">setStyle</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">element</span><span class="o">,</span> <span class="s1">'display'</span><span class="o">,</span> <span class="s1">'block'</span><span class="o">);</span>
            <span class="o">});</span>
            <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">);</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @method openWindow</span>
<span class="c">        * @param {&lt;a href="YAHOO.widget.EditorWindow.html"&gt;YAHOO.widget.EditorWindow&lt;/a&gt;} win A &lt;a href="YAHOO.widget.EditorWindow.html"&gt;YAHOO.widget.EditorWindow&lt;/a&gt; instance</span>
<span class="c">        * @description Opens a new "window/panel"</span>
<span class="c">        */</span>
        <span class="nx">openWindow</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">win</span><span class="o">)</span> <span class="o">{</span>
            <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">'openWindow: '</span> <span class="o">+</span> <span class="nx">win</span><span class="o">.</span><span class="nx">name</span><span class="o">,</span> <span class="s1">'info'</span><span class="o">,</span> <span class="s1">'Editor'</span><span class="o">);</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">toolbar</span><span class="o">.</span><span class="nx">set</span><span class="o">(</span><span class="s1">'disabled'</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span> <span class="c">//Disable the toolbar when an editor window is open..</span>
<span class="c"></span>            <span class="nx">Event</span><span class="o">.</span><span class="nx">on</span><span class="o">(</span><span class="nb">document</span><span class="o">,</span> <span class="s1">'keypress'</span><span class="o">,</span> <span class="k">this</span><span class="o">.</span><span class="nx">_closeWindow</span><span class="o">,</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">EditorInfo</span><span class="o">.</span><span class="nb">window</span><span class="o">.</span><span class="nx">win</span> <span class="o">&amp;&amp;</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">EditorInfo</span><span class="o">.</span><span class="nb">window</span><span class="o">.</span><span class="nx">scope</span><span class="o">)</span> <span class="o">{</span>
                <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">EditorInfo</span><span class="o">.</span><span class="nb">window</span><span class="o">.</span><span class="nx">scope</span><span class="o">.</span><span class="nx">closeWindow</span><span class="o">.</span><span class="nx">call</span><span class="o">(</span><span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">EditorInfo</span><span class="o">.</span><span class="nb">window</span><span class="o">.</span><span class="nx">scope</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">EditorInfo</span><span class="o">.</span><span class="nb">window</span><span class="o">.</span><span class="nx">win</span> <span class="o">=</span> <span class="nx">win</span><span class="o">;</span>
            <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">EditorInfo</span><span class="o">.</span><span class="nb">window</span><span class="o">.</span><span class="nx">scope</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>

            <span class="k">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="o">,</span>
                <span class="nx">xy</span> <span class="o">=</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">getXY</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">]),</span>
                <span class="nx">elXY</span> <span class="o">=</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">getXY</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'iframe'</span><span class="o">).</span><span class="nx">get</span><span class="o">(</span><span class="s1">'element'</span><span class="o">)),</span>
                <span class="nx">panel</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">),</span>
                <span class="nx">newXY</span> <span class="o">=</span> <span class="o">[(</span><span class="nx">xy</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">+</span> <span class="nx">elXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">-</span> <span class="m">20</span><span class="o">),</span> <span class="o">(</span><span class="nx">xy</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">+</span> <span class="nx">elXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">+</span> <span class="m">10</span><span class="o">)],</span>
                <span class="nx">wWidth</span> <span class="o">=</span> <span class="o">(</span><span class="nb">parseInt</span><span class="o">(</span><span class="nx">win</span><span class="o">.</span><span class="nx">attrs</span><span class="o">.</span><span class="nx">width</span><span class="o">,</span> <span class="m">10</span><span class="o">)</span> <span class="o">/</span> <span class="m">2</span><span class="o">),</span>
                <span class="nx">align</span> <span class="o">=</span> <span class="s1">'center'</span><span class="o">,</span>
                <span class="nx">body</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

            <span class="k">this</span><span class="o">.</span><span class="nx">fireEvent</span><span class="o">(</span><span class="s1">'beforeOpenWindow'</span><span class="o">,</span> <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'beforeOpenWindow'</span><span class="o">,</span> <span class="nx">win</span><span class="o">:</span> <span class="nx">win</span><span class="o">,</span> <span class="nx">panel</span><span class="o">:</span> <span class="nx">panel</span> <span class="o">});</span>

            <span class="nx">body</span> <span class="o">=</span> <span class="nb">document</span><span class="o">.</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'div'</span><span class="o">);</span>
            <span class="nx">body</span><span class="o">.</span><span class="nx">className</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">CLASS_PREFIX</span> <span class="o">+</span> <span class="s1">'-body-cont'</span><span class="o">;</span>
            <span class="k">for</span> <span class="o">(</span><span class="k">var</span> <span class="nx">b</span> <span class="k">in</span> <span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">[</span><span class="nx">b</span><span class="o">])</span> <span class="o">{</span>
                    <span class="nx">Dom</span><span class="o">.</span><span class="nx">addClass</span><span class="o">(</span><span class="nx">body</span><span class="o">,</span> <span class="nx">b</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="nx">Dom</span><span class="o">.</span><span class="nx">addClass</span><span class="o">(</span><span class="nx">body</span><span class="o">,</span> <span class="o">((</span><span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">Button</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_defaultToolbar</span><span class="o">.</span><span class="nx">buttonType</span> <span class="o">==</span> <span class="s1">'advanced'</span><span class="o">))</span> <span class="o">?</span> <span class="s1">'good-button'</span> <span class="o">:</span> <span class="s1">'no-button'</span><span class="o">));</span>

            <span class="k">var</span> <span class="nx">_note</span> <span class="o">=</span> <span class="nb">document</span><span class="o">.</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'h3'</span><span class="o">);</span>
            <span class="nx">_note</span><span class="o">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">'yui-editor-skipheader'</span><span class="o">;</span>
            <span class="nx">_note</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_CLOSE_WINDOW_NOTE</span><span class="o">;</span>
            <span class="nx">body</span><span class="o">.</span><span class="nx">appendChild</span><span class="o">(</span><span class="nx">_note</span><span class="o">);</span>
            <span class="nx">form</span> <span class="o">=</span> <span class="nb">document</span><span class="o">.</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'form'</span><span class="o">);</span>
            <span class="nx">form</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">'method'</span><span class="o">,</span> <span class="s1">'GET'</span><span class="o">);</span>
            <span class="k">var</span> <span class="nx">windowName</span> <span class="o">=</span> <span class="nx">win</span><span class="o">.</span><span class="nx">name</span><span class="o">;</span>
            <span class="nx">Event</span><span class="o">.</span><span class="nx">on</span><span class="o">(</span><span class="nx">form</span><span class="o">,</span> <span class="s1">'submit'</span><span class="o">,</span> <span class="k">function</span><span class="o">(</span><span class="nx">ev</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">var</span> <span class="nx">evName</span> <span class="o">=</span> <span class="s1">'window'</span> <span class="o">+</span> <span class="nx">windowName</span> <span class="o">+</span> <span class="s1">'Submit'</span><span class="o">;</span>
                <span class="nx">self</span><span class="o">.</span><span class="nx">fireEvent</span><span class="o">(</span><span class="nx">evName</span><span class="o">,</span> <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">evName</span><span class="o">,</span> <span class="nx">target</span><span class="o">:</span> <span class="k">this</span> <span class="o">});</span>
                <span class="nx">Event</span><span class="o">.</span><span class="nx">stopEvent</span><span class="o">(</span><span class="nx">ev</span><span class="o">);</span>
            <span class="o">},</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
            <span class="nx">body</span><span class="o">.</span><span class="nx">appendChild</span><span class="o">(</span><span class="nx">form</span><span class="o">);</span>

            <span class="k">if</span> <span class="o">(</span><span class="nx">Lang</span><span class="o">.</span><span class="nx">isObject</span><span class="o">(</span><span class="nx">win</span><span class="o">.</span><span class="nx">body</span><span class="o">))</span> <span class="o">{</span> <span class="c">//Assume it's a reference</span>
<span class="c"></span>                <span class="nx">form</span><span class="o">.</span><span class="nx">appendChild</span><span class="o">(</span><span class="nx">win</span><span class="o">.</span><span class="nx">body</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span> <span class="c">//Assume it's a string</span>
<span class="c"></span>                <span class="k">var</span> <span class="nx">_tmp</span> <span class="o">=</span> <span class="nb">document</span><span class="o">.</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'div'</span><span class="o">);</span>
                <span class="nx">_tmp</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">win</span><span class="o">.</span><span class="nx">body</span><span class="o">;</span>
                <span class="nx">form</span><span class="o">.</span><span class="nx">appendChild</span><span class="o">(</span><span class="nx">_tmp</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">var</span> <span class="nx">_close</span> <span class="o">=</span> <span class="nb">document</span><span class="o">.</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'span'</span><span class="o">);</span>
            <span class="nx">_close</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'X'</span><span class="o">;</span>
            <span class="nx">_close</span><span class="o">.</span><span class="nx">title</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">STR_CLOSE_WINDOW</span><span class="o">;</span>
            <span class="nx">_close</span><span class="o">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">'close'</span><span class="o">;</span>
            <span class="nx">Event</span><span class="o">.</span><span class="nx">on</span><span class="o">(</span><span class="nx">_close</span><span class="o">,</span> <span class="s1">'click'</span><span class="o">,</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">closeWindow</span><span class="o">();</span>
            <span class="o">},</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
            <span class="k">var</span> <span class="nx">_knob</span> <span class="o">=</span> <span class="nb">document</span><span class="o">.</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'span'</span><span class="o">);</span>
            <span class="nx">_knob</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'^'</span><span class="o">;</span>
            <span class="nx">_knob</span><span class="o">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">'knob'</span><span class="o">;</span>
            <span class="nx">win</span><span class="o">.</span><span class="nx">_knob</span> <span class="o">=</span> <span class="nx">_knob</span><span class="o">;</span>

            <span class="k">var</span> <span class="nx">_header</span> <span class="o">=</span> <span class="nb">document</span><span class="o">.</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'h3'</span><span class="o">);</span>
            <span class="nx">_header</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">win</span><span class="o">.</span><span class="nx">header</span><span class="o">;</span>

            <span class="nx">panel</span><span class="o">.</span><span class="nx">cfg</span><span class="o">.</span><span class="nx">setProperty</span><span class="o">(</span><span class="s1">'width'</span><span class="o">,</span> <span class="nx">win</span><span class="o">.</span><span class="nx">attrs</span><span class="o">.</span><span class="nx">width</span><span class="o">);</span>
            <span class="nx">panel</span><span class="o">.</span><span class="nx">setHeader</span><span class="o">(</span><span class="s1">' '</span><span class="o">);</span> <span class="c">//Clear the current header</span>
<span class="c"></span>            <span class="nx">panel</span><span class="o">.</span><span class="nx">appendToHeader</span><span class="o">(</span><span class="nx">_header</span><span class="o">);</span>
            <span class="nx">_header</span><span class="o">.</span><span class="nx">appendChild</span><span class="o">(</span><span class="nx">_close</span><span class="o">);</span>
            <span class="nx">_header</span><span class="o">.</span><span class="nx">appendChild</span><span class="o">(</span><span class="nx">_knob</span><span class="o">);</span>
            <span class="nx">panel</span><span class="o">.</span><span class="nx">setBody</span><span class="o">(</span><span class="s1">' '</span><span class="o">);</span> <span class="c">//Clear the current body</span>
<span class="c"></span>            <span class="nx">panel</span><span class="o">.</span><span class="nx">setFooter</span><span class="o">(</span><span class="s1">' '</span><span class="o">);</span> <span class="c">//Clear the current footer</span>
<span class="c"></span>            <span class="k">if</span> <span class="o">(</span><span class="nx">win</span><span class="o">.</span><span class="nx">footer</span> <span class="o">!==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="nx">panel</span><span class="o">.</span><span class="nx">setFooter</span><span class="o">(</span><span class="nx">win</span><span class="o">.</span><span class="nx">footer</span><span class="o">);</span>
                <span class="nx">Dom</span><span class="o">.</span><span class="nx">addClass</span><span class="o">(</span><span class="nx">panel</span><span class="o">.</span><span class="nx">footer</span><span class="o">,</span> <span class="s1">'open'</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="nx">Dom</span><span class="o">.</span><span class="nx">removeClass</span><span class="o">(</span><span class="nx">panel</span><span class="o">.</span><span class="nx">footer</span><span class="o">,</span> <span class="s1">'open'</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="nx">panel</span><span class="o">.</span><span class="nx">appendToBody</span><span class="o">(</span><span class="nx">body</span><span class="o">);</span> <span class="c">//Append the new DOM node to it</span>
<span class="c"></span>            <span class="k">var</span> <span class="nx">fireShowEvent</span> <span class="o">=</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                <span class="nx">panel</span><span class="o">.</span><span class="nx">bringToTop</span><span class="o">();</span>
                <span class="nx">Event</span><span class="o">.</span><span class="nx">on</span><span class="o">(</span><span class="nx">panel</span><span class="o">.</span><span class="nx">element</span><span class="o">,</span> <span class="s1">'click'</span><span class="o">,</span> <span class="k">function</span><span class="o">(</span><span class="nx">ev</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nx">Event</span><span class="o">.</span><span class="nx">stopPropagation</span><span class="o">(</span><span class="nx">ev</span><span class="o">);</span>
                <span class="o">});</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">_setBusy</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
                <span class="nx">panel</span><span class="o">.</span><span class="nx">showEvent</span><span class="o">.</span><span class="nx">unsubscribe</span><span class="o">(</span><span class="nx">fireShowEvent</span><span class="o">);</span>
            <span class="o">};</span>
            <span class="nx">panel</span><span class="o">.</span><span class="nx">showEvent</span><span class="o">.</span><span class="nx">subscribe</span><span class="o">(</span><span class="nx">fireShowEvent</span><span class="o">,</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
            <span class="k">var</span> <span class="nx">fireCloseEvent</span> <span class="o">=</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">currentWindow</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
                <span class="k">var</span> <span class="nx">evName</span> <span class="o">=</span> <span class="s1">'window'</span> <span class="o">+</span> <span class="nx">windowName</span> <span class="o">+</span> <span class="s1">'Close'</span><span class="o">;</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">fireEvent</span><span class="o">(</span><span class="nx">evName</span><span class="o">,</span> <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">evName</span><span class="o">,</span> <span class="nx">target</span><span class="o">:</span> <span class="k">this</span> <span class="o">});</span>
                <span class="nx">panel</span><span class="o">.</span><span class="nx">hideEvent</span><span class="o">.</span><span class="nx">unsubscribe</span><span class="o">(</span><span class="nx">fireCloseEvent</span><span class="o">);</span>
            <span class="o">};</span>
            <span class="nx">panel</span><span class="o">.</span><span class="nx">hideEvent</span><span class="o">.</span><span class="nx">subscribe</span><span class="o">(</span><span class="nx">fireCloseEvent</span><span class="o">,</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">currentWindow</span> <span class="o">=</span> <span class="nx">win</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">moveWindow</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
            <span class="nx">panel</span><span class="o">.</span><span class="nx">show</span><span class="o">();</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">fireEvent</span><span class="o">(</span><span class="s1">'afterOpenWindow'</span><span class="o">,</span> <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'afterOpenWindow'</span><span class="o">,</span> <span class="nx">win</span><span class="o">:</span> <span class="nx">win</span><span class="o">,</span> <span class="nx">panel</span><span class="o">:</span> <span class="nx">panel</span> <span class="o">});</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @method moveWindow</span>
<span class="c">        * @param {Boolean} force Boolean to tell it to move but not use any animation (Usually done the first time the window is loaded.)</span>
<span class="c">        * @description Realign the window with the currentElement and reposition the knob above the panel.</span>
<span class="c">        */</span>
        <span class="nx">moveWindow</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">force</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(!</span><span class="k">this</span><span class="o">.</span><span class="nx">currentWindow</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">var</span> <span class="nx">win</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">currentWindow</span><span class="o">,</span>
                <span class="nx">xy</span> <span class="o">=</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">getXY</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">]),</span>
                <span class="nx">elXY</span> <span class="o">=</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">getXY</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'iframe'</span><span class="o">).</span><span class="nx">get</span><span class="o">(</span><span class="s1">'element'</span><span class="o">)),</span>
                <span class="nx">panel</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">),</span>
                <span class="c">//newXY = [(xy[0] + elXY[0] - 20), (xy[1] + elXY[1] + 10)],</span>
<span class="c"></span>                <span class="nx">newXY</span> <span class="o">=</span> <span class="o">[(</span><span class="nx">xy</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">+</span> <span class="nx">elXY</span><span class="o">[</span><span class="m">0</span><span class="o">]),</span> <span class="o">(</span><span class="nx">xy</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">+</span> <span class="nx">elXY</span><span class="o">[</span><span class="m">1</span><span class="o">])],</span>
                <span class="nx">wWidth</span> <span class="o">=</span> <span class="o">(</span><span class="nb">parseInt</span><span class="o">(</span><span class="nx">win</span><span class="o">.</span><span class="nx">attrs</span><span class="o">.</span><span class="nx">width</span><span class="o">,</span> <span class="m">10</span><span class="o">)</span> <span class="o">/</span> <span class="m">2</span><span class="o">),</span>
                <span class="nx">align</span> <span class="o">=</span> <span class="s1">'center'</span><span class="o">,</span>
                <span class="nx">orgXY</span> <span class="o">=</span> <span class="nx">panel</span><span class="o">.</span><span class="nx">cfg</span><span class="o">.</span><span class="nx">getProperty</span><span class="o">(</span><span class="s1">'xy'</span><span class="o">),</span>
                <span class="nx">_knob</span> <span class="o">=</span> <span class="nx">win</span><span class="o">.</span><span class="nx">_knob</span><span class="o">,</span>
                <span class="nx">xDiff</span> <span class="o">=</span> <span class="m">0</span><span class="o">,</span>
                <span class="nx">yDiff</span> <span class="o">=</span> <span class="m">0</span><span class="o">,</span>
                <span class="nx">anim</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

            <span class="nx">newXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">=</span> <span class="o">((</span><span class="nx">newXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">-</span> <span class="nx">wWidth</span><span class="o">)</span> <span class="o">+</span> <span class="m">20</span><span class="o">);</span>
            <span class="c">//Account for the Scroll bars in a scrolled editor window.</span>
<span class="c"></span>            <span class="nx">newXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">=</span> <span class="nx">newXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">-</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">getDocumentScrollLeft</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_getDoc</span><span class="o">());</span>
            <span class="nx">newXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">=</span> <span class="nx">newXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">-</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">getDocumentScrollTop</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_getDoc</span><span class="o">());</span>
            


            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_isElement</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">],</span> <span class="s1">'img'</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">].</span><span class="nx">src</span><span class="o">.</span><span class="nx">indexOf</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'blankimage'</span><span class="o">))</span> <span class="o">!=</span> <span class="o">-</span><span class="m">1</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nx">newXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="nx">newXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">+</span> <span class="o">(</span><span class="m">75</span> <span class="sr">/ 2)); /</span><span class="o">/</span><span class="nx">Placeholder</span> <span class="nx">size</span>
                    <span class="nx">newXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="nx">newXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">+</span> <span class="m">75</span><span class="o">);</span> <span class="c">//Placeholder sizea</span>
<span class="c"></span>                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="k">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">].</span><span class="nx">width</span><span class="o">,</span> <span class="m">10</span><span class="o">);</span>
                    <span class="k">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">].</span><span class="nx">height</span><span class="o">,</span> <span class="m">10</span><span class="o">);</span>
                    <span class="nx">newXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="nx">newXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">+</span> <span class="o">(</span><span class="nx">w</span> <span class="o">/</span> <span class="m">2</span><span class="o">));</span>
                    <span class="nx">newXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="nx">newXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">+</span> <span class="nx">h</span><span class="o">);</span>
                <span class="o">}</span>
                <span class="nx">newXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">=</span> <span class="nx">newXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">+</span> <span class="m">15</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="k">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">Dom</span><span class="o">.</span><span class="nx">getStyle</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">],</span> <span class="s1">'fontSize'</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span><span class="nx">fs</span> <span class="o">&amp;&amp;</span> <span class="nx">fs</span><span class="o">.</span><span class="nx">indexOf</span> <span class="o">&amp;&amp;</span> <span class="nx">fs</span><span class="o">.</span><span class="nx">indexOf</span><span class="o">(</span><span class="s1">'px'</span><span class="o">)</span> <span class="o">!=</span> <span class="o">-</span><span class="m">1</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nx">newXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">=</span> <span class="nx">newXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="o">(</span><span class="nx">Dom</span><span class="o">.</span><span class="nx">getStyle</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">],</span> <span class="s1">'fontSize'</span><span class="o">),</span> <span class="m">10</span><span class="o">)</span> <span class="o">+</span> <span class="m">5</span><span class="o">;</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="nx">newXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">=</span> <span class="nx">newXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">+</span> <span class="m">20</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(</span><span class="nx">newXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">&lt;</span> <span class="nx">elXY</span><span class="o">[</span><span class="m">0</span><span class="o">])</span> <span class="o">{</span>
                <span class="nx">newXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">=</span> <span class="nx">elXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">+</span> <span class="m">5</span><span class="o">;</span>
                <span class="nx">align</span> <span class="o">=</span> <span class="s1">'left'</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="k">if</span> <span class="o">((</span><span class="nx">newXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">+</span> <span class="o">(</span><span class="nx">wWidth</span> <span class="o">*</span> <span class="m">2</span><span class="o">))</span> <span class="o">&gt;</span> <span class="o">(</span><span class="nx">elXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'iframe'</span><span class="o">).</span><span class="nx">get</span><span class="o">(</span><span class="s1">'element'</span><span class="o">).</span><span class="nx">clientWidth</span><span class="o">,</span> <span class="m">10</span><span class="o">)))</span> <span class="o">{</span>
                <span class="nx">newXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">=</span> <span class="o">((</span><span class="nx">elXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'iframe'</span><span class="o">).</span><span class="nx">get</span><span class="o">(</span><span class="s1">'element'</span><span class="o">).</span><span class="nx">clientWidth</span><span class="o">,</span> <span class="m">10</span><span class="o">))</span> <span class="o">-</span> <span class="o">(</span><span class="nx">wWidth</span> <span class="o">*</span> <span class="m">2</span><span class="o">)</span> <span class="o">-</span> <span class="m">5</span><span class="o">);</span>
                <span class="nx">align</span> <span class="o">=</span> <span class="s1">'right'</span><span class="o">;</span>
            <span class="o">}</span>
            
            <span class="k">try</span> <span class="o">{</span>
                <span class="nx">xDiff</span> <span class="o">=</span> <span class="o">(</span><span class="nx">newXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">-</span> <span class="nx">orgXY</span><span class="o">[</span><span class="m">0</span><span class="o">]);</span>
                <span class="nx">yDiff</span> <span class="o">=</span> <span class="o">(</span><span class="nx">newXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span> <span class="o">-</span> <span class="nx">orgXY</span><span class="o">[</span><span class="m">1</span><span class="o">]);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nx">e</span><span class="o">)</span> <span class="o">{}</span>
            
            <span class="c">//Convert negative numbers to positive so we can get the difference in distance</span>
<span class="c"></span>            <span class="nx">xDiff</span> <span class="o">=</span> <span class="o">((</span><span class="nx">xDiff</span> <span class="o">&lt;</span> <span class="m">0</span><span class="o">)</span> <span class="o">?</span> <span class="o">(</span><span class="nx">xDiff</span> <span class="o">*</span> <span class="o">-</span><span class="m">1</span><span class="o">)</span> <span class="o">:</span> <span class="nx">xDiff</span><span class="o">);</span>
            <span class="nx">yDiff</span> <span class="o">=</span> <span class="o">((</span><span class="nx">yDiff</span> <span class="o">&lt;</span> <span class="m">0</span><span class="o">)</span> <span class="o">?</span> <span class="o">(</span><span class="nx">yDiff</span> <span class="o">*</span> <span class="o">-</span><span class="m">1</span><span class="o">)</span> <span class="o">:</span> <span class="nx">yDiff</span><span class="o">);</span>

            <span class="k">if</span> <span class="o">(((</span><span class="nx">xDiff</span> <span class="o">&gt;</span> <span class="m">10</span><span class="o">)</span> <span class="o">||</span> <span class="o">(</span><span class="nx">yDiff</span> <span class="o">&gt;</span> <span class="m">10</span><span class="o">))</span> <span class="o">||</span> <span class="nx">force</span><span class="o">)</span> <span class="o">{</span> <span class="c">//Only move the window if it's supposed to move more than 10px or force was passed (new window)</span>
<span class="c"></span>                <span class="k">var</span> <span class="nx">_knobLeft</span> <span class="o">=</span> <span class="m">0</span><span class="o">,</span>
                    <span class="nx">elW</span> <span class="o">=</span> <span class="m">0</span><span class="o">;</span>

                <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">].</span><span class="nx">width</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nx">elW</span> <span class="o">=</span> <span class="o">(</span><span class="nb">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">].</span><span class="nx">width</span><span class="o">,</span> <span class="m">10</span><span class="o">)</span> <span class="o">/</span> <span class="m">2</span><span class="o">);</span>
                <span class="o">}</span>

                <span class="k">var</span> <span class="nx">leftOffset</span> <span class="o">=</span> <span class="nx">xy</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">+</span> <span class="nx">elXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">+</span> <span class="nx">elW</span><span class="o">;</span>
                <span class="nx">_knobLeft</span> <span class="o">=</span> <span class="nx">leftOffset</span> <span class="o">-</span> <span class="nx">newXY</span><span class="o">[</span><span class="m">0</span><span class="o">];</span>
                <span class="c">//Check to see if the knob will go off either side &amp; reposition it</span>
<span class="c"></span>                <span class="k">if</span> <span class="o">(</span><span class="nx">_knobLeft</span> <span class="o">&gt;</span> <span class="o">(</span><span class="nb">parseInt</span><span class="o">(</span><span class="nx">win</span><span class="o">.</span><span class="nx">attrs</span><span class="o">.</span><span class="nx">width</span><span class="o">,</span> <span class="m">10</span><span class="o">)</span> <span class="o">-</span> <span class="m">40</span><span class="o">))</span> <span class="o">{</span>
                    <span class="nx">_knobLeft</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="o">(</span><span class="nx">win</span><span class="o">.</span><span class="nx">attrs</span><span class="o">.</span><span class="nx">width</span><span class="o">,</span> <span class="m">10</span><span class="o">)</span> <span class="o">-</span> <span class="m">40</span><span class="o">;</span>
                <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="nx">_knobLeft</span> <span class="o">&lt;</span> <span class="m">40</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nx">_knobLeft</span> <span class="o">=</span> <span class="m">40</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="k">if</span> <span class="o">(</span><span class="nb">isNaN</span><span class="o">(</span><span class="nx">_knobLeft</span><span class="o">))</span> <span class="o">{</span>
                    <span class="nx">_knobLeft</span> <span class="o">=</span> <span class="m">40</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="k">if</span> <span class="o">(</span><span class="nx">force</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">_knob</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">_knob</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">left</span> <span class="o">=</span> <span class="nx">_knobLeft</span> <span class="o">+</span> <span class="s1">'px'</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'animate'</span><span class="o">))</span> <span class="o">{</span>
                        <span class="nx">Dom</span><span class="o">.</span><span class="nx">setStyle</span><span class="o">(</span><span class="nx">panel</span><span class="o">.</span><span class="nx">element</span><span class="o">,</span> <span class="s1">'opacity'</span><span class="o">,</span> <span class="s1">'0'</span><span class="o">);</span>
                        <span class="nx">anim</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Anim</span><span class="o">(</span><span class="nx">panel</span><span class="o">.</span><span class="nx">element</span><span class="o">,</span> <span class="o">{</span>
                            <span class="nx">opacity</span><span class="o">:</span> <span class="o">{</span>
                                <span class="nx">from</span><span class="o">:</span> <span class="m">0</span><span class="o">,</span>
                                <span class="nx">to</span><span class="o">:</span> <span class="m">1</span>
                            <span class="o">}</span>
                        <span class="o">},</span> <span class="m">0</span><span class="o">.</span><span class="m">1</span><span class="o">,</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Easing</span><span class="o">.</span><span class="nx">easeOut</span><span class="o">);</span>
                        <span class="nx">panel</span><span class="o">.</span><span class="nx">cfg</span><span class="o">.</span><span class="nx">setProperty</span><span class="o">(</span><span class="s1">'xy'</span><span class="o">,</span> <span class="nx">newXY</span><span class="o">);</span>
                        <span class="nx">anim</span><span class="o">.</span><span class="nx">onComplete</span><span class="o">.</span><span class="nx">subscribe</span><span class="o">(</span><span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">ie</span><span class="o">)</span> <span class="o">{</span>
                                <span class="nx">panel</span><span class="o">.</span><span class="nx">element</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">filter</span> <span class="o">=</span> <span class="s1">'none'</span><span class="o">;</span>
                            <span class="o">}</span>
                        <span class="o">},</span> <span class="k">this</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
                        <span class="nx">anim</span><span class="o">.</span><span class="nx">animate</span><span class="o">();</span>
                    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                        <span class="nx">panel</span><span class="o">.</span><span class="nx">cfg</span><span class="o">.</span><span class="nx">setProperty</span><span class="o">(</span><span class="s1">'xy'</span><span class="o">,</span> <span class="nx">newXY</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'animate'</span><span class="o">))</span> <span class="o">{</span>
                        <span class="nx">anim</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Anim</span><span class="o">(</span><span class="nx">panel</span><span class="o">.</span><span class="nx">element</span><span class="o">,</span> <span class="o">{},</span> <span class="m">0</span><span class="o">.</span><span class="m">5</span><span class="o">,</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Easing</span><span class="o">.</span><span class="nx">easeOut</span><span class="o">);</span>
                        <span class="nx">anim</span><span class="o">.</span><span class="nx">attributes</span> <span class="o">=</span> <span class="o">{</span>
                            <span class="nx">top</span><span class="o">:</span> <span class="o">{</span>
                                <span class="nx">to</span><span class="o">:</span> <span class="nx">newXY</span><span class="o">[</span><span class="m">1</span><span class="o">]</span>
                            <span class="o">},</span>
                            <span class="nx">left</span><span class="o">:</span> <span class="o">{</span>
                                <span class="nx">to</span><span class="o">:</span> <span class="nx">newXY</span><span class="o">[</span><span class="m">0</span><span class="o">]</span>
                            <span class="o">}</span>
                        <span class="o">};</span>
                        <span class="nx">anim</span><span class="o">.</span><span class="nx">onComplete</span><span class="o">.</span><span class="nx">subscribe</span><span class="o">(</span><span class="k">function</span><span class="o">()</span> <span class="o">{</span>
                            <span class="nx">panel</span><span class="o">.</span><span class="nx">cfg</span><span class="o">.</span><span class="nx">setProperty</span><span class="o">(</span><span class="s1">'xy'</span><span class="o">,</span> <span class="nx">newXY</span><span class="o">);</span>
                        <span class="o">});</span>
                        <span class="c">//We have to animate the iframe shim at the same time as the panel or we get scrollbar bleed ..</span>
<span class="c"></span>                        <span class="k">var</span> <span class="nx">iframeAnim</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Anim</span><span class="o">(</span><span class="nx">panel</span><span class="o">.</span><span class="nx">iframe</span><span class="o">,</span> <span class="nx">anim</span><span class="o">.</span><span class="nx">attributes</span><span class="o">,</span> <span class="m">0</span><span class="o">.</span><span class="m">5</span><span class="o">,</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Easing</span><span class="o">.</span><span class="nx">easeOut</span><span class="o">);</span>

                        <span class="k">var</span> <span class="nx">_knobAnim</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Anim</span><span class="o">(</span><span class="nx">_knob</span><span class="o">,</span> <span class="o">{</span>
                            <span class="nx">left</span><span class="o">:</span> <span class="o">{</span>
                                <span class="nx">to</span><span class="o">:</span> <span class="nx">_knobLeft</span>
                            <span class="o">}</span>
                        <span class="o">},</span> <span class="m">0</span><span class="o">.</span><span class="m">6</span><span class="o">,</span> <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Easing</span><span class="o">.</span><span class="nx">easeOut</span><span class="o">);</span>
                        <span class="nx">anim</span><span class="o">.</span><span class="nx">animate</span><span class="o">();</span>
                        <span class="nx">iframeAnim</span><span class="o">.</span><span class="nx">animate</span><span class="o">();</span>
                        <span class="nx">_knobAnim</span><span class="o">.</span><span class="nx">animate</span><span class="o">();</span>
                    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                        <span class="nx">_knob</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">left</span> <span class="o">=</span> <span class="nx">_knobLeft</span> <span class="o">+</span> <span class="s1">'px'</span><span class="o">;</span>
                        <span class="nx">panel</span><span class="o">.</span><span class="nx">cfg</span><span class="o">.</span><span class="nx">setProperty</span><span class="o">(</span><span class="s1">'xy'</span><span class="o">,</span> <span class="nx">newXY</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @private</span>
<span class="c">        * @method _closeWindow</span>
<span class="c">        * @description Close the currently open EditorWindow with the Escape key.</span>
<span class="c">        * @param {Event} ev The keypress Event that we are trapping</span>
<span class="c">        */</span>
        <span class="nx">_closeWindow</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">ev</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">((</span><span class="nx">ev</span><span class="o">.</span><span class="nx">charCode</span> <span class="o">==</span> <span class="m">87</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="nx">ev</span><span class="o">.</span><span class="nx">shiftKey</span> <span class="o">&amp;&amp;</span> <span class="nx">ev</span><span class="o">.</span><span class="nx">ctrlKey</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentWindow</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">closeWindow</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @method closeWindow</span>
<span class="c">        * @description Close the currently open EditorWindow.</span>
<span class="c">        */</span>
        <span class="nx">closeWindow</span><span class="o">:</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
            <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">'closeWindow: '</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="nx">currentWindow</span><span class="o">.</span><span class="nx">name</span><span class="o">,</span> <span class="s1">'info'</span><span class="o">,</span> <span class="s1">'Editor'</span><span class="o">);</span>
            <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">EditorInfo</span><span class="o">.</span><span class="nb">window</span> <span class="o">=</span> <span class="o">{};</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">fireEvent</span><span class="o">(</span><span class="s1">'closeWindow'</span><span class="o">,</span> <span class="o">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'closeWindow'</span><span class="o">,</span> <span class="nx">win</span><span class="o">:</span> <span class="k">this</span><span class="o">.</span><span class="nx">currentWindow</span> <span class="o">});</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">currentWindow</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">hide</span><span class="o">();</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">cfg</span><span class="o">.</span><span class="nx">setProperty</span><span class="o">(</span><span class="s1">'xy'</span><span class="o">,</span> <span class="o">[-</span><span class="m">900</span><span class="o">,-</span><span class="m">900</span><span class="o">]);</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'panel'</span><span class="o">).</span><span class="nx">syncIframe</span><span class="o">();</span> <span class="c">//Needed to move the iframe with the hidden panel</span>
<span class="c"></span>            <span class="k">this</span><span class="o">.</span><span class="nx">unsubscribeAll</span><span class="o">(</span><span class="s1">'afterExecCommand'</span><span class="o">);</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">toolbar</span><span class="o">.</span><span class="nx">set</span><span class="o">(</span><span class="s1">'disabled'</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span> <span class="c">//enable the toolbar now that the window is closed</span>
<span class="c"></span>            <span class="k">this</span><span class="o">.</span><span class="nx">toolbar</span><span class="o">.</span><span class="nx">resetAllButtons</span><span class="o">();</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">_focusWindow</span><span class="o">();</span>
            <span class="nx">Event</span><span class="o">.</span><span class="nx">removeListener</span><span class="o">(</span><span class="nb">document</span><span class="o">,</span> <span class="s1">'keypress'</span><span class="o">,</span> <span class="k">this</span><span class="o">.</span><span class="nx">_closeWindow</span><span class="o">);</span>
        <span class="o">},</span>
        <span class="c">/* {{{  Command Overrides - These commands are only over written when we are using the advanced version */</span>
        <span class="c">/**</span>
<span class="c">        * @method cmd_heading</span>
<span class="c">        * @param value Value passed from the execCommand method</span>
<span class="c">        * @description This is an execCommand override method. It is called from execCommand when the execCommand('heading') is used.</span>
<span class="c">        */</span>
        <span class="nx">cmd_heading</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">value</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">var</span> <span class="nx">exec</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span>
                <span class="nx">el</span> <span class="o">=</span> <span class="kc">null</span><span class="o">,</span>
                <span class="nx">action</span> <span class="o">=</span> <span class="s1">'heading'</span><span class="o">,</span>
                <span class="nx">_sel</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_getSelection</span><span class="o">(),</span>
                <span class="nx">_selEl</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_getSelectedElement</span><span class="o">();</span>

            <span class="k">if</span> <span class="o">(</span><span class="nx">_selEl</span><span class="o">)</span> <span class="o">{</span>
                <span class="nx">_sel</span> <span class="o">=</span> <span class="nx">_selEl</span><span class="o">;</span>
            <span class="o">}</span>
            
            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">ie</span><span class="o">)</span> <span class="o">{</span>
                <span class="nx">action</span> <span class="o">=</span> <span class="s1">'formatblock'</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(</span><span class="nx">value</span> <span class="o">==</span> <span class="s1">'none'</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">((</span><span class="nx">_sel</span> <span class="o">&amp;&amp;</span> <span class="nx">_sel</span><span class="o">.</span><span class="nx">tagName</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="nx">_sel</span><span class="o">.</span><span class="nx">tagName</span><span class="o">.</span><span class="nx">toLowerCase</span><span class="o">().</span><span class="nx">substring</span><span class="o">(</span><span class="m">0</span><span class="o">,</span><span class="m">1</span><span class="o">)</span> <span class="o">==</span> <span class="s1">'h'</span><span class="o">))</span> <span class="o">||</span> <span class="o">(</span><span class="nx">_sel</span> <span class="o">&amp;&amp;</span> <span class="nx">_sel</span><span class="o">.</span><span class="nx">parentNode</span> <span class="o">&amp;&amp;</span> <span class="nx">_sel</span><span class="o">.</span><span class="nx">parentNode</span><span class="o">.</span><span class="nx">tagName</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="nx">_sel</span><span class="o">.</span><span class="nx">parentNode</span><span class="o">.</span><span class="nx">tagName</span><span class="o">.</span><span class="nx">toLowerCase</span><span class="o">().</span><span class="nx">substring</span><span class="o">(</span><span class="m">0</span><span class="o">,</span><span class="m">1</span><span class="o">)</span> <span class="o">==</span> <span class="s1">'h'</span><span class="o">)))</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">(</span><span class="nx">_sel</span><span class="o">.</span><span class="nx">parentNode</span><span class="o">.</span><span class="nx">tagName</span><span class="o">.</span><span class="nx">toLowerCase</span><span class="o">().</span><span class="nx">substring</span><span class="o">(</span><span class="m">0</span><span class="o">,</span><span class="m">1</span><span class="o">)</span> <span class="o">==</span> <span class="s1">'h'</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">_sel</span> <span class="o">=</span> <span class="nx">_sel</span><span class="o">.</span><span class="nx">parentNode</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_isElement</span><span class="o">(</span><span class="nx">_sel</span><span class="o">,</span> <span class="s1">'html'</span><span class="o">))</span> <span class="o">{</span>
                        <span class="k">return</span> <span class="o">[</span><span class="kc">false</span><span class="o">];</span>
                    <span class="o">}</span>
                    <span class="nx">el</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_swapEl</span><span class="o">(</span><span class="nx">_selEl</span><span class="o">,</span> <span class="s1">'span'</span><span class="o">,</span> <span class="k">function</span><span class="o">(</span><span class="nx">el</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">el</span><span class="o">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">'yui-non'</span><span class="o">;</span>
                    <span class="o">});</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">_selectNode</span><span class="o">(</span><span class="nx">el</span><span class="o">);</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">=</span> <span class="nx">el</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="nx">exec</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_isElement</span><span class="o">(</span><span class="nx">_selEl</span><span class="o">,</span> <span class="s1">'h1'</span><span class="o">)</span> <span class="o">||</span> <span class="k">this</span><span class="o">.</span><span class="nx">_isElement</span><span class="o">(</span><span class="nx">_selEl</span><span class="o">,</span> <span class="s1">'h2'</span><span class="o">)</span> <span class="o">||</span> <span class="k">this</span><span class="o">.</span><span class="nx">_isElement</span><span class="o">(</span><span class="nx">_selEl</span><span class="o">,</span> <span class="s1">'h3'</span><span class="o">)</span> <span class="o">||</span> <span class="k">this</span><span class="o">.</span><span class="nx">_isElement</span><span class="o">(</span><span class="nx">_selEl</span><span class="o">,</span> <span class="s1">'h4'</span><span class="o">)</span> <span class="o">||</span> <span class="k">this</span><span class="o">.</span><span class="nx">_isElement</span><span class="o">(</span><span class="nx">_selEl</span><span class="o">,</span> <span class="s1">'h5'</span><span class="o">)</span> <span class="o">||</span> <span class="k">this</span><span class="o">.</span><span class="nx">_isElement</span><span class="o">(</span><span class="nx">_selEl</span><span class="o">,</span> <span class="s1">'h6'</span><span class="o">))</span> <span class="o">{</span>
                    <span class="nx">el</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_swapEl</span><span class="o">(</span><span class="nx">_selEl</span><span class="o">,</span> <span class="nx">value</span><span class="o">);</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">_selectNode</span><span class="o">(</span><span class="nx">el</span><span class="o">);</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">=</span> <span class="nx">el</span><span class="o">;</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">_createCurrentElement</span><span class="o">(</span><span class="nx">value</span><span class="o">);</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">_selectNode</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">]);</span>
                <span class="o">}</span>
                <span class="nx">exec</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="o">[</span><span class="nx">exec</span><span class="o">,</span> <span class="nx">action</span><span class="o">];</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @method cmd_hiddenelements</span>
<span class="c">        * @param value Value passed from the execCommand method</span>
<span class="c">        * @description This is an execCommand override method. It is called from execCommand when the execCommand('hiddenelements') is used.</span>
<span class="c">        */</span>
        <span class="nx">cmd_hiddenelements</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">value</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_showingHiddenElements</span><span class="o">)</span> <span class="o">{</span>
                <span class="c">//Don't auto highlight the hidden button</span>
<span class="c"></span>                <span class="k">this</span><span class="o">.</span><span class="nx">_lastButton</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
                <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">'Enabling hidden CSS File'</span><span class="o">,</span> <span class="s1">'info'</span><span class="o">,</span> <span class="s1">'SimpleEditor'</span><span class="o">);</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">_showingHiddenElements</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">toolbar</span><span class="o">.</span><span class="nx">deselectButton</span><span class="o">(</span><span class="s1">'hiddenelements'</span><span class="o">);</span>
                <span class="nx">Dom</span><span class="o">.</span><span class="nx">removeClass</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_getDoc</span><span class="o">().</span><span class="nx">body</span><span class="o">,</span> <span class="k">this</span><span class="o">.</span><span class="nx">CLASS_HIDDEN</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">'Disabling hidden CSS File'</span><span class="o">,</span> <span class="s1">'info'</span><span class="o">,</span> <span class="s1">'SimpleEditor'</span><span class="o">);</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">_showingHiddenElements</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
                <span class="nx">Dom</span><span class="o">.</span><span class="nx">addClass</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_getDoc</span><span class="o">().</span><span class="nx">body</span><span class="o">,</span> <span class="k">this</span><span class="o">.</span><span class="nx">CLASS_HIDDEN</span><span class="o">);</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">toolbar</span><span class="o">.</span><span class="nx">selectButton</span><span class="o">(</span><span class="s1">'hiddenelements'</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="o">[</span><span class="kc">false</span><span class="o">];</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @method cmd_removeformat</span>
<span class="c">        * @param value Value passed from the execCommand method</span>
<span class="c">        * @description This is an execCommand override method. It is called from execCommand when the execCommand('removeformat') is used.</span>
<span class="c">        */</span>
        <span class="nx">cmd_removeformat</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">value</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">var</span> <span class="nx">exec</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="c">/**</span>
<span class="c">            * @knownissue Remove Format issue</span>
<span class="c">            * @browser Safari 2.x</span>
<span class="c">            * @description There is an issue here with Safari, that it may not always remove the format of the item that is selected.</span>
<span class="c">            * Due to the way that Safari 2.x handles ranges, it is very difficult to determine what the selection holds.</span>
<span class="c">            * So here we are making the best possible guess and acting on it.</span>
<span class="c">            */</span>
            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">webkit</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="o">.</span><span class="nx">_getDoc</span><span class="o">().</span><span class="nx">queryCommandEnabled</span><span class="o">(</span><span class="s1">'removeformat'</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">var</span> <span class="nx">_txt</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_getSelection</span><span class="o">()+</span><span class="s1">''</span><span class="o">;</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">_createCurrentElement</span><span class="o">(</span><span class="s1">'span'</span><span class="o">);</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">].</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">'yui-non'</span><span class="o">;</span>
                <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">].</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">_txt</span><span class="o">;</span>
                <span class="k">for</span> <span class="o">(</span><span class="k">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="m">1</span><span class="o">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">.</span><span class="nx">length</span><span class="o">;</span> <span class="nx">i</span><span class="o">++)</span> <span class="o">{</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="nx">i</span><span class="o">].</span><span class="nx">parentNode</span><span class="o">.</span><span class="nx">removeChild</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="nx">i</span><span class="o">]);</span>
                <span class="o">}</span>
                <span class="c">/*</span>
<span class="c">                this._createCurrentElement('span');</span>
<span class="c">                YAHOO.util.Dom.addClass(this.currentElement[0], 'yui-non');</span>
<span class="c">                var re= /&lt;\S[^&gt;&lt;]*&gt;/g;</span>
<span class="c">                var str = this.currentElement[0].innerHTML.replace(re, '');</span>
<span class="c">                var _txt = this._getDoc().createTextNode(str);</span>
<span class="c">                this.currentElement[0].parentNode.parentNode.replaceChild(_txt, this.currentElement[0].parentNode);</span>
<span class="c">                */</span>
                
                <span class="nx">exec</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="o">[</span><span class="nx">exec</span><span class="o">];</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @method cmd_script</span>
<span class="c">        * @param action action passed from the execCommand method</span>
<span class="c">        * @param value Value passed from the execCommand method</span>
<span class="c">        * @description This is a combined execCommand override method. It is called from the cmd_superscript and cmd_subscript methods.</span>
<span class="c">        */</span>
        <span class="nx">cmd_script</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">action</span><span class="o">,</span> <span class="nx">value</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">var</span> <span class="nx">exec</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="nx">tag</span> <span class="o">=</span> <span class="nx">action</span><span class="o">.</span><span class="nx">toLowerCase</span><span class="o">().</span><span class="nx">substring</span><span class="o">(</span><span class="m">0</span><span class="o">,</span> <span class="m">3</span><span class="o">),</span>
                <span class="nx">_span</span> <span class="o">=</span> <span class="kc">null</span><span class="o">,</span> <span class="nx">_selEl</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_getSelectedElement</span><span class="o">();</span>

            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">webkit</span><span class="o">)</span> <span class="o">{</span>
                <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">'Safari dom fun again ('</span> <span class="o">+</span> <span class="nx">action</span> <span class="o">+</span> <span class="s1">')..'</span><span class="o">,</span> <span class="s1">'info'</span><span class="o">,</span> <span class="s1">'EditorSafari'</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_isElement</span><span class="o">(</span><span class="nx">_selEl</span><span class="o">,</span> <span class="nx">tag</span><span class="o">))</span> <span class="o">{</span>
                    <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">'we are a child of tag ('</span> <span class="o">+</span> <span class="nx">tag</span> <span class="o">+</span> <span class="s1">'), reverse process'</span><span class="o">,</span> <span class="s1">'info'</span><span class="o">,</span> <span class="s1">'EditorSafari'</span><span class="o">);</span>
                    <span class="nx">_span</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_swapEl</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">],</span> <span class="s1">'span'</span><span class="o">,</span> <span class="k">function</span><span class="o">(</span><span class="nx">el</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nx">el</span><span class="o">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">'yui-non'</span><span class="o">;</span>
                    <span class="o">});</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">_selectNode</span><span class="o">(</span><span class="nx">_span</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">_createCurrentElement</span><span class="o">(</span><span class="nx">tag</span><span class="o">);</span>
                    <span class="k">var</span> <span class="nx">_sub</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_swapEl</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">],</span> <span class="nx">tag</span><span class="o">);</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">_selectNode</span><span class="o">(</span><span class="nx">_sub</span><span class="o">);</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="o">=</span> <span class="nx">_sub</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="nx">exec</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="nx">exec</span><span class="o">;</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @method cmd_superscript</span>
<span class="c">        * @param value Value passed from the execCommand method</span>
<span class="c">        * @description This is an execCommand override method. It is called from execCommand when the execCommand('superscript') is used.</span>
<span class="c">        */</span>
        <span class="nx">cmd_superscript</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">value</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="o">[</span><span class="k">this</span><span class="o">.</span><span class="nx">cmd_script</span><span class="o">(</span><span class="s1">'superscript'</span><span class="o">,</span> <span class="nx">value</span><span class="o">)];</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @method cmd_subscript</span>
<span class="c">        * @param value Value passed from the execCommand method</span>
<span class="c">        * @description This is an execCommand override method. It is called from execCommand when the execCommand('subscript') is used.</span>
<span class="c">        */</span>
        <span class="nx">cmd_subscript</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">value</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="o">[</span><span class="k">this</span><span class="o">.</span><span class="nx">cmd_script</span><span class="o">(</span><span class="s1">'subscript'</span><span class="o">,</span> <span class="nx">value</span><span class="o">)];</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @method cmd_indent</span>
<span class="c">        * @param value Value passed from the execCommand method</span>
<span class="c">        * @description This is an execCommand override method. It is called from execCommand when the execCommand('indent') is used.</span>
<span class="c">        */</span>
        <span class="nx">cmd_indent</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">value</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">var</span> <span class="nx">exec</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="nx">selEl</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_getSelectedElement</span><span class="o">(),</span> <span class="nx">_bq</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">webkit</span> <span class="o">||</span> <span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">ie</span> <span class="o">||</span> <span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">gecko</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_isElement</span><span class="o">(</span><span class="nx">selEl</span><span class="o">,</span> <span class="s1">'blockquote'</span><span class="o">))</span> <span class="o">{</span>
                    <span class="nx">_bq</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_getDoc</span><span class="o">().</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'blockquote'</span><span class="o">);</span>
                    <span class="nx">_bq</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">selEl</span><span class="o">.</span><span class="nx">innerHTML</span><span class="o">;</span>
                    <span class="nx">selEl</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">''</span><span class="o">;</span>
                    <span class="nx">selEl</span><span class="o">.</span><span class="nx">appendChild</span><span class="o">(</span><span class="nx">_bq</span><span class="o">);</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">_selectNode</span><span class="o">(</span><span class="nx">_bq</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">_createCurrentElement</span><span class="o">(</span><span class="s1">'blockquote'</span><span class="o">);</span>
                    <span class="k">for</span> <span class="o">(</span><span class="k">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="m">0</span><span class="o">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">.</span><span class="nx">length</span><span class="o">;</span> <span class="nx">i</span><span class="o">++)</span> <span class="o">{</span>
                        <span class="nx">_bq</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_getDoc</span><span class="o">().</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'blockquote'</span><span class="o">);</span>
                        <span class="nx">_bq</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="nx">i</span><span class="o">].</span><span class="nx">innerHTML</span><span class="o">;</span>
                        <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="nx">i</span><span class="o">].</span><span class="nx">parentNode</span><span class="o">.</span><span class="nx">replaceChild</span><span class="o">(</span><span class="nx">_bq</span><span class="o">,</span> <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="nx">i</span><span class="o">]);</span>
                        <span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="nx">i</span><span class="o">]</span> <span class="o">=</span> <span class="nx">_bq</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="k">this</span><span class="o">.</span><span class="nx">_selectNode</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">currentElement</span><span class="o">[</span><span class="m">0</span><span class="o">]);</span>
                <span class="o">}</span>
                <span class="nx">exec</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="nx">value</span> <span class="o">=</span> <span class="s1">'blockquote'</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="o">[</span><span class="nx">exec</span><span class="o">,</span> <span class="s1">'indent'</span><span class="o">,</span> <span class="nx">value</span><span class="o">];</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @method cmd_outdent</span>
<span class="c">        * @param value Value passed from the execCommand method</span>
<span class="c">        * @description This is an execCommand override method. It is called from execCommand when the execCommand('outdent') is used.</span>
<span class="c">        */</span>
        <span class="nx">cmd_outdent</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">value</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">var</span> <span class="nx">exec</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="nx">selEl</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_getSelectedElement</span><span class="o">(),</span> <span class="nx">_bq</span> <span class="o">=</span> <span class="kc">null</span><span class="o">,</span> <span class="nx">_span</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">webkit</span> <span class="o">||</span> <span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">ie</span> <span class="o">||</span> <span class="k">this</span><span class="o">.</span><span class="nx">browser</span><span class="o">.</span><span class="nx">gecko</span><span class="o">)</span> <span class="o">{</span>
                <span class="nx">selEl</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_getSelectedElement</span><span class="o">();</span>
                <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_isElement</span><span class="o">(</span><span class="nx">selEl</span><span class="o">,</span> <span class="s1">'blockquote'</span><span class="o">))</span> <span class="o">{</span>
                    <span class="k">var</span> <span class="nx">par</span> <span class="o">=</span> <span class="nx">selEl</span><span class="o">.</span><span class="nx">parentNode</span><span class="o">;</span>
                    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">_isElement</span><span class="o">(</span><span class="nx">selEl</span><span class="o">.</span><span class="nx">parentNode</span><span class="o">,</span> <span class="s1">'blockquote'</span><span class="o">))</span> <span class="o">{</span>
                        <span class="nx">par</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">selEl</span><span class="o">.</span><span class="nx">innerHTML</span><span class="o">;</span>
                        <span class="k">this</span><span class="o">.</span><span class="nx">_selectNode</span><span class="o">(</span><span class="nx">par</span><span class="o">);</span>
                    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                        <span class="nx">_span</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="nx">_getDoc</span><span class="o">().</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">'span'</span><span class="o">);</span>
                        <span class="nx">_span</span><span class="o">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">selEl</span><span class="o">.</span><span class="nx">innerHTML</span><span class="o">;</span>
                        <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">util</span><span class="o">.</span><span class="nx">Dom</span><span class="o">.</span><span class="nx">addClass</span><span class="o">(</span><span class="nx">_span</span><span class="o">,</span> <span class="s1">'yui-non'</span><span class="o">);</span>
                        <span class="nx">par</span><span class="o">.</span><span class="nx">replaceChild</span><span class="o">(</span><span class="nx">_span</span><span class="o">,</span> <span class="nx">selEl</span><span class="o">);</span>
                        <span class="k">this</span><span class="o">.</span><span class="nx">_selectNode</span><span class="o">(</span><span class="nx">_span</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">log</span><span class="o">(</span><span class="s1">'Can not outdent, we are not inside a blockquote'</span><span class="o">,</span> <span class="s1">'warn'</span><span class="o">,</span> <span class="s1">'Editor'</span><span class="o">);</span>
                <span class="o">}</span>
                <span class="nx">exec</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="nx">value</span> <span class="o">=</span> <span class="s1">'blockquote'</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="o">[</span><span class="nx">exec</span><span class="o">,</span> <span class="s1">'indent'</span><span class="o">,</span> <span class="nx">value</span><span class="o">];</span>
        <span class="o">},</span>
        <span class="c">/* }}}*/</span>        
        <span class="c">/**</span>
<span class="c">        * @method toString</span>
<span class="c">        * @description Returns a string representing the editor.</span>
<span class="c">        * @return {String}</span>
<span class="c">        */</span>
        <span class="nx">toString</span><span class="o">:</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">'Editor'</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="nx">get</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'element_cont'</span><span class="o">))</span> <span class="o">{</span>
                <span class="nx">str</span> <span class="o">=</span> <span class="s1">'Editor (#'</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'element_cont'</span><span class="o">).</span><span class="nx">get</span><span class="o">(</span><span class="s1">'id'</span><span class="o">)</span> <span class="o">+</span> <span class="s1">')'</span> <span class="o">+</span> <span class="o">((</span><span class="k">this</span><span class="o">.</span><span class="nx">get</span><span class="o">(</span><span class="s1">'disabled'</span><span class="o">)</span> <span class="o">?</span> <span class="s1">' Disabled'</span> <span class="o">:</span> <span class="s1">''</span><span class="o">));</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="nx">str</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">});</span>
    <span class="c">/**</span>
<span class="c">     * @description Class to hold Window information between uses. We use the same panel to show the windows, so using this will allow you to configure a window before it is shown.</span>
<span class="c">     * This is what you pass to Editor.openWindow();. These parameters will not take effect until the openWindow() is called in the editor.</span>
<span class="c">     * @class EditorWindow</span>
<span class="c">     * @param {String} name The name of the window.</span>
<span class="c">     * @param {Object} attrs Attributes for the window. Current attributes used are : height and width</span>
<span class="c">    */</span>
    <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">EditorWindow</span> <span class="o">=</span> <span class="k">function</span><span class="o">(</span><span class="nx">name</span><span class="o">,</span> <span class="nx">attrs</span><span class="o">)</span> <span class="o">{</span>
        <span class="c">/**</span>
<span class="c">        * @private</span>
<span class="c">        * @property name</span>
<span class="c">        * @description A unique name for the window</span>
<span class="c">        */</span>
        <span class="k">this</span><span class="o">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="o">.</span><span class="nx">replace</span><span class="o">(</span><span class="s1">' '</span><span class="o">,</span> <span class="s1">'_'</span><span class="o">);</span>
        <span class="c">/**</span>
<span class="c">        * @private</span>
<span class="c">        * @property attrs</span>
<span class="c">        * @description The window attributes</span>
<span class="c">        */</span>
        <span class="k">this</span><span class="o">.</span><span class="nx">attrs</span> <span class="o">=</span> <span class="nx">attrs</span><span class="o">;</span>
    <span class="o">};</span>

    <span class="nx">YAHOO</span><span class="o">.</span><span class="nx">widget</span><span class="o">.</span><span class="nx">EditorWindow</span><span class="o">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="o">{</span>
        <span class="c">/**</span>
<span class="c">        * @private</span>
<span class="c">        * @property _cache</span>
<span class="c">        * @description Holds a cache of the DOM for the window so we only have to build it once..</span>
<span class="c">        */</span>
        <span class="nx">_cache</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @private</span>
<span class="c">        * @property header</span>
<span class="c">        * @description Holder for the header of the window, used in Editor.openWindow</span>
<span class="c">        */</span>
        <span class="nx">header</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @private</span>
<span class="c">        * @property body</span>
<span class="c">        * @description Holder for the body of the window, used in Editor.openWindow</span>
<span class="c">        */</span>
        <span class="nx">body</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @private</span>
<span class="c">        * @property footer</span>
<span class="c">        * @description Holder for the footer of the window, used in Editor.openWindow</span>
<span class="c">        */</span>
        <span class="nx">footer</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
        <span class="c">/**</span>
<span class="c">        * @method setHeader</span>
<span class="c">        * @description Sets the header for the window.</span>
<span class="c">        * @param {String/HTMLElement} str The string or DOM reference to be used as the windows header.</span>
<span class="c">        */</span>
        <span class="nx">setHeader</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">str</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">header</span> <span class="o">=</span> <span class="nx">str</span><span class="o">;</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @method setBody</span>
<span class="c">        * @description Sets the body for the window.</span>
<span class="c">        * @param {String/HTMLElement} str The string or DOM reference to be used as the windows body.</span>
<span class="c">        */</span>
        <span class="nx">setBody</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">str</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">body</span> <span class="o">=</span> <span class="nx">str</span><span class="o">;</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @method setFooter</span>
<span class="c">        * @description Sets the footer for the window.</span>
<span class="c">        * @param {String/HTMLElement} str The string or DOM reference to be used as the windows footer.</span>
<span class="c">        */</span>
        <span class="nx">setFooter</span><span class="o">:</span> <span class="k">function</span><span class="o">(</span><span class="nx">str</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="nx">footer</span> <span class="o">=</span> <span class="nx">str</span><span class="o">;</span>
        <span class="o">},</span>
        <span class="c">/**</span>
<span class="c">        * @method toString</span>
<span class="c">        * @description Returns a string representing the EditorWindow.</span>
<span class="c">        * @return {String}</span>
<span class="c">        */</span>
        <span class="nx">toString</span><span class="o">:</span> <span class="k">function</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s1">'Editor Window ('</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">')'</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">};</span>
<span class="c">/**</span>
<span class="c">* @event beforeOpenWindow</span>
<span class="c">* @param {&lt;a href="YAHOO.widget.EditorWindow.html"&gt;EditorWindow&lt;/a&gt;} win The EditorWindow object</span>
<span class="c">* @param {Overlay} panel The Overlay object that is used to create the window.</span>
<span class="c">* @description Event fires before an Editor Window is opened. See &lt;a href="YAHOO.util.Element.html#addListener"&gt;Element.addListener&lt;/a&gt; for more information on listening for this event.</span>
<span class="c">* @type YAHOO.util.CustomEvent</span>
<span class="c">*/</span>
<span class="c">/**</span>
<span class="c">* @event afterOpenWindow</span>
<span class="c">* @param {&lt;a href="YAHOO.widget.EditorWindow.html"&gt;EditorWindow&lt;/a&gt;} win The EditorWindow object</span>
<span class="c">* @param {Overlay} panel The Overlay object that is used to create the window.</span>
<span class="c">* @description Event fires after an Editor Window is opened. See &lt;a href="YAHOO.util.Element.html#addListener"&gt;Element.addListener&lt;/a&gt; for more information on listening for this event.</span>
<span class="c">* @type YAHOO.util.CustomEvent</span>
<span class="c">*/</span>
<span class="c">/**</span>
<span class="c">* @event closeWindow</span>
<span class="c">* @param {&lt;a href="YAHOO.widget.EditorWindow.html"&gt;EditorWindow&lt;/a&gt;} win The EditorWindow object</span>
<span class="c">* @description Event fires after an Editor Window is closed. See &lt;a href="YAHOO.util.Element.html#addListener"&gt;Element.addListener&lt;/a&gt; for more information on listening for this event.</span>
<span class="c">* @type YAHOO.util.CustomEvent</span>
<span class="c">*/</span>
<span class="c">/**</span>
<span class="c">* @event windowCMDOpen</span>
<span class="c">* @param {&lt;a href="YAHOO.widget.EditorWindow.html"&gt;EditorWindow&lt;/a&gt;} win The EditorWindow object</span>
<span class="c">* @param {Overlay} panel The Overlay object that is used to create the window.</span>
<span class="c">* @description Dynamic event fired when an &lt;a href="YAHOO.widget.EditorWindow.html"&gt;EditorWindow&lt;/a&gt; is opened.. The dynamic event is based on the name of the window. Example Window: createlink, opening this window would fire the windowcreatelinkOpen event. See &lt;a href="YAHOO.util.Element.html#addListener"&gt;Element.addListener&lt;/a&gt; for more information on listening for this event.</span>
<span class="c">* @type YAHOO.util.CustomEvent</span>
<span class="c">*/</span>
<span class="c">/**</span>
<span class="c">* @event windowCMDClose</span>
<span class="c">* @param {&lt;a href="YAHOO.widget.EditorWindow.html"&gt;EditorWindow&lt;/a&gt;} win The EditorWindow object</span>
<span class="c">* @param {Overlay} panel The Overlay object that is used to create the window.</span>
<span class="c">* @description Dynamic event fired when an &lt;a href="YAHOO.widget.EditorWindow.html"&gt;EditorWindow&lt;/a&gt; is closed.. The dynamic event is based on the name of the window. Example Window: createlink, opening this window would fire the windowcreatelinkClose event. See &lt;a href="YAHOO.util.Element.html#addListener"&gt;Element.addListener&lt;/a&gt; for more information on listening for this event.</span>
<span class="c">* @type YAHOO.util.CustomEvent</span>
<span class="c">*/</span>

<span class="o">})();</span>
</pre></div>
                    </div>
			</div>
		</div>
		<div class="yui-b">
            <div class="nav">

                    <div class="module">
                        <h4>Modules</h4>
                        <ul class="content"><li class=""><a href="module_animation.html">animation</a></li>

                                <li class=""><a href="module_autocomplete.html">autocomplete</a></li>

                                <li class=""><a href="module_button.html">button</a></li>

                                <li class=""><a href="module_calendar.html">calendar</a></li>

                                <li class=""><a href="module_charts.html">charts</a></li>

                                <li class=""><a href="module_colorpicker.html">colorpicker</a></li>

                                <li class=""><a href="module_connection.html">connection</a></li>

                                <li class=""><a href="module_container.html">container</a></li>

                                <li class=""><a href="module_datasource.html">datasource</a></li>

                                <li class=""><a href="module_datatable.html">datatable</a></li>

                                <li class=""><a href="module_date.html">date</a></li>

                                <li class=""><a href="module_dom.html">dom</a></li>

                                <li class=""><a href="module_dragdrop.html">dragdrop</a></li>

                                <li class="selected"><a href="module_editor.html">editor</a></li>

                                <li class=""><a href="module_element.html">element</a></li>

                                <li class=""><a href="module_event.html">event</a></li>

                                <li class=""><a href="module_get.html">get</a></li>

                                <li class=""><a href="module_history.html">history</a></li>

                                <li class=""><a href="module_imageloader.html">imageloader</a></li>

                                <li class=""><a href="module_json.html">json</a></li>

                                <li class=""><a href="module_logger.html">logger</a></li>

                                <li class=""><a href="module_menu.html">menu</a></li>

                                <li class=""><a href="module_number.html">number</a></li>

                                <li class=""><a href="module_profiler.html">profiler</a></li>

                                <li class=""><a href="module_selector.html">selector</a></li>

                                <li class=""><a href="module_slider.html">slider</a></li>

                                <li class=""><a href="module_tabview.html">tabview</a></li>

                                <li class=""><a href="module_treeview.html">treeview</a></li>

                                <li class=""><a href="module_yahoo.html">yahoo</a></li>

                                <li class=""><a href="module_yuiloader.html">yuiloader</a></li>

                                <li class=""><a href="module_yuitest.html">yuitest</a></li>
                        </ul></div>

                    <div class="module">
                        <h4>Classes</h4>
                        <ul class="content"><li class=""><a href="YAHOO.widget.Editor.html">YAHOO.widget.Editor</a></li>
                                <li class=""><a href="YAHOO.widget.EditorInfo.html">YAHOO.widget.EditorInfo</a></li>
                                <li class=""><a href="YAHOO.widget.EditorWindow.html">YAHOO.widget.EditorWindow</a></li>
                                <li class=""><a href="YAHOO.widget.SimpleEditor.html">YAHOO.widget.SimpleEditor</a></li>
                                <li class=""><a href="YAHOO.widget.Toolbar.html">YAHOO.widget.Toolbar</a></li>
                                <li class=""><a href="YAHOO.widget.ToolbarButton.html">YAHOO.widget.ToolbarButton</a></li>
                                <li class=""><a href="YAHOO.widget.ToolbarButtonAdvanced.html">YAHOO.widget.ToolbarButtonAdvanced</a></li>
                        </ul></div>

                    <div class="module">
                        <h4>Files</h4>
                        <ul class="content"><li class="selected"><a href="editor.js.html">editor.js</a></li>
                                <li class=""><a href="simple-editor.js.html">simple-editor.js</a></li>
                                <li class=""><a href="toolbar-button.js.html">toolbar-button.js</a></li>
                                <li class=""><a href="toolbar.js.html">toolbar.js</a></li>
                        </ul></div>





            </div>
		</div>
	</div>
	<div id="ft">
        <hr>
        Copyright Â© 2007 Yahoo! Inc. All rights reserved.
	</div>
</div></body>