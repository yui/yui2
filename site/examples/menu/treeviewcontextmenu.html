<?php
$prepend = '<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.6.0/build/menu/assets/skins/sam/menu.css" />
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.6.0/build/treeview/assets/skins/sam/treeview.css" />
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.6.0/build/button/assets/skins/sam/button.css" />
<script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/yuiloader/yuiloader-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/dom/dom-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/event/event-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/container/container_core-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/menu/menu-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/treeview/treeview-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/element/element-beta-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.6.0/build/button/button-min.js"></script>

<!--there is no custom header content for this example-->

';
$section="examples";
$highlightSyntax = true;
$assetsDirectory = "assets/";
$releasenotes = false;
$bodyclass = " yui-skin-sam";
$title = "YUI Library Examples: Menu Family: Adding A Context Menu To A TreeView";
include("../../inc/header.inc"); 
?>
		
	
	<div id="yui-main">
		<div class="yui-b">
		  <div class="yui-ge">
			  <div class="yui-u first example">

    
	<div class="promo">
	<h1>Menu Family: Adding A Context Menu To A TreeView</h1>
	
	<div class="exampleIntro">
	<p>
This example demonstates how to use the ContextMenu widget to add a context menu 
to a YUI TreeView control.  The context menu allows the user to add, edit and 
remove items from a TreeView instance.  
</p>
<p>
<em>Please Note:</em> Opera users will need to do the following to use 
this example:
</p>
<ul id="operainstructions">
    <li>
        <em>Opera for Windows:</em>  Hold down the control key and click with 
        the left mouse button.
    </li>
    <li>
        <em>Opera for OS X:</em>  Hold down the command key (&#8984;) and click
        with the left mouse button.
    </li>
</ul>			
	</div>	
					
	<div class="example-container module  newWindow">
			<div id="example-canvas" class="bd">
	
		<p class="newWindowButton yui-skin-sam"><span id="newWindowLink"><span class="first-child"><a href="treeviewcontextmenu_source.html" target="_blank">View example in new window.</a></span></span>		
	
		
		</div>
		
	
	</div>			
	</div>
		
	<p>
When adding context menus to large data structures like a 
<code>&#60;table&#62;</code> or large list (<code>&#60;ol&#62;</code> 
or <code>&#60;ul&#62;</code>), it is recommended to bind a single 
YAHOO.widget.ContextMenu instance to the structure's root element, than to a set 
of its child nodes (<code>&#60;tr&#62;</code>s or <code>&#60;li&#62;</code>s).
Doing so significantly improves the performance of a web page or 
application by reducing the number of "contextmenu" event handlers 
as well as the number of YAHOO.widget.ContextMenu instances in memory.
</p>
<p>
Begin by creating a TreeView instance.  Next, create an object that maps 
HTML ids to their corresponding TextNode instances.  As each TextNode instance 
is added to the TreeView, store a reference to it in the map.
</p>
<textarea name="code" class="JScript" cols="60" rows="1">
/*
     Initialize the TreeView instance when the "mytreeview" <div>
     is ready to be scripted.
*/

YAHOO.util.Event.onAvailable("mytreeview", function () {

    /*
         Map of YAHOO.widget.TextNode instances in the 
         TreeView instance.
    */

    var oTextNodeMap = {};


    // Creates a TextNode instance and appends it to the TreeView 

    function buildRandomTextBranch(p_oNode) {

        var oTextNode,
            i;

        if (p_oNode.depth < 6) {

            for (i = 0; i < Math.floor(Math.random() * 4); i++) {

                oTextNode = new YAHOO.widget.TextNode(p_oNode.label + "-" + i, p_oNode, false);

                oTextNodeMap[oTextNode.labelElId] = oTextNode;
                
                buildRandomTextBranch(oTextNode);

            }

        }

    }


    // Create a TreeView instance

    var oTreeView = new YAHOO.widget.TreeView("mytreeview");

    var n, oTextNode;

    for (n = 0; n < Math.floor((Math.random()*4) + 3); n++) {

        oTextNode = new YAHOO.widget.TextNode("label-" + n, oTreeView.getRoot(), false);
        
        /*
             Add the TextNode instance to the map, using its
             HTML id as the key.
        */
        
        oTextNodeMap[oTextNode.labelElId] = oTextNode;
        
        buildRandomTextBranch(oTextNode);

    }

    oTreeView.draw();

});
</textarea>
<p>
Once the TreeView is created, instantiate a ContextMenu specifying the TreeView 
instance's root element as its trigger.  Lastly, add a "triggerContextMenu" 
event handler for the ContextMenu instance that uses the "contextEventTarget" 
property to retrieve the TextNode instance that triggered its display.   
A reference to the TextNode is stored in a variable 
(<code>oCurrentTextNode</code>), so that it can be manipulated by the 
<code>addNode</code>, <code>editNodeLabel</code>, and <code>deleteNode</code> 
functions.
</p>
<textarea name="code" class="JScript" cols="60" rows="1">
/*
     The YAHOO.widget.TextNode instance whose "contextmenu" 
     DOM event triggered the display of the 
     ContextMenu instance.
*/

var oCurrentTextNode = null;


/*
     Adds a new TextNode as a child of the TextNode instance 
     that was the target of the "contextmenu" event that 
     triggered the display of the ContextMenu instance.
*/

function addNode() {

    var sLabel = window.prompt("Enter a label for the new node: ", ""),
        oChildNode;

    if (sLabel && sLabel.length > 0) {
        
        oChildNode = new YAHOO.widget.TextNode(sLabel, oCurrentTextNode, false);

        oCurrentTextNode.refresh();
        oCurrentTextNode.expand();

        oTextNodeMap[oChildNode.labelElId] = oChildNode;

    }

}


/*
     Edits the label of the TextNode that was the target of the
     "contextmenu" event that triggered the display of the 
     ContextMenu instance.
*/

function editNodeLabel() {

    var sLabel = window.prompt("Enter a new label for this node: ", oCurrentTextNode.getLabelEl().innerHTML);

    if (sLabel && sLabel.length > 0) {
        
        oCurrentTextNode.getLabelEl().innerHTML = sLabel;

    }

}


/*
    Deletes the TextNode that was the target of the "contextmenu"
    event that triggered the display of the ContextMenu instance.
*/

function deleteNode() {

    delete oTextNodeMap[oCurrentTextNode.labelElId];

    oTreeView.removeNode(oCurrentTextNode);
    oTreeView.draw();

}


/*
    "contextmenu" event handler for the element(s) that 
    triggered the display of the ContextMenu instance - used
    to set a reference to the TextNode instance that triggered
    the display of the ContextMenu instance.
*/

function onTriggerContextMenu(p_oEvent) {

	var oTarget = this.contextEventTarget,
		Dom = YAHOO.util.Dom;

	/*
		 Get the TextNode instance that that triggered the 
		 display of the ContextMenu instance.
	*/

	var oTextNode = Dom.hasClass(oTarget, "ygtvlabel") ? 
						oTarget : Dom.getAncestorByClassName(oTarget, "ygtvlabel");

	if (oTextNode) {

		oCurrentTextNode = oTextNodeMap[oTarget.id];

	}
	else {
	
		// Cancel the display of the ContextMenu instance.
	
		this.cancel();
		
	}

}


/*
     Instantiate a ContextMenu:  The first argument passed to 
     the constructor is the id of the element to be created; the 
     second is an object literal of configuration properties.
*/

var oContextMenu = new YAHOO.widget.ContextMenu("mytreecontextmenu", {
                                                trigger: "mytreeview",
                                                lazyload: true, 
                                                itemdata: [
                                                    { text: "Add Child Node", onclick: { fn: addNode } },
                                                    { text: "Edit Node Label", onclick: { fn: editNodeLabel } },
                                                    { text: "Delete Node", onclick: { fn: deleteNode } }
                                                ] });


/*
     Subscribe to the "contextmenu" event for the element(s)
     specified as the "trigger" for the ContextMenu instance.
*/

oContextMenu.subscribe("triggerContextMenu", onTriggerContextMenu);
</textarea>

<h2>Configuration for This Example</h2>

<p>You can load the necessary JavaScript and CSS for this example from Yahoo's servers.  <a href="http://developer.yahoo.com/yui/articles/hosting/?menu&reset&fonts&treeview&MIN#configure">Click here to load the YUI Dependency Configurator with all of this example's dependencies preconfigured</a>.</p>

				</div>
				<div class="yui-u">
					
				
					<div id="examples">
						<h3 class='firstContent'>Menu Family Examples:</h3>
	
						<div id="exampleToc">
							<ul>
								<li><a href='../menu/example01.html'>Basic Menu From Markup</a></li><li><a href='../menu/example02.html'>Basic Menu From JavaScript</a></li><li><a href='../menu/example03.html'>Grouped Menu Items Using Markup</a></li><li><a href='../menu/example04.html'>Grouped Menu Items Using JavaScript</a></li><li><a href='../menu/example05.html'>Grouped Menu Items With Titles From Markup</a></li><li><a href='../menu/example06.html'>Grouped Menu Items With Titles From JavaScript</a></li><li><a href='../menu/example07.html'>Multi-tiered Menu From Markup</a></li><li><a href='../menu/example08.html'>Multi-tiered Menu From JavaScript</a></li><li><a href='../menu/example09.html'>Handling Menu Click Events</a></li><li><a href='../menu/example10.html'>Listening For Menu Events</a></li><li><a href='../menu/example11.html'>MenuItem Configuration Properties</a></li><li><a href='../menu/example12.html'>Setting Menu Configuration Properties At Runtime</a></li><li><a href='../menu/leftnavfrommarkup.html'>Website Left Nav With Submenus Built From Markup</a></li><li><a href='../menu/leftnavfromjs.html'>Website Left Nav With Submenus From JavaScript</a></li><li><a href='../menu/topnavfrommarkup.html'>Website Top Nav With Submenus Built From Markup</a></li><li><a href='../menu/topnavfromjs.html'>Website Top Nav With Submenus From JavaScript</a></li><li><a href='../menu/leftnavfrommarkupwithanim.html'>Website Left Nav Using Animation With Submenus Built From Markup</a></li><li><a href='../menu/leftnavfromjswithanim.html'>Website Left Nav Using Animation With Submenus From JavaScript</a></li><li><a href='../menu/topnavfrommarkupwithanim.html'>Website Top Nav Using Animation With Submenus Built From Markup</a></li><li><a href='../menu/topnavfromjswithanim.html'>Website Top Nav Using Animation With Submenus From JavaScript</a></li><li><a href='../menu/contextmenu.html'>Context Menu</a></li><li><a href='../menu/tablecontextmenu.html'>Adding A Context Menu To A Table</a></li><li class='selected'><a href='../menu/treeviewcontextmenu.html'>Adding A Context Menu To A TreeView</a></li><li><a href='../menu/programsmenu.html'>OS-Style Programs Menu</a></li><li><a href='../menu/applicationmenubar.html'>Application Menubar</a></li><li><a href='../menu/menuwaiaria.html'>Using the Menu ARIA Plugin</a></li><li><a href='../button/button-ariaplugin.html'>Using the Button ARIA Plugin (included with examples for Button Control)</a></li><li><a href='../datatable/dt_contextmenu.html'>Context Menu Integration (included with examples for DataTable Control)</a></li><li><a href='../button/btn_example07.html'>Menu Buttons (included with examples for Button Control)</a></li><li><a href='../button/btn_example08.html'>Split Buttons (included with examples for Button Control)</a></li><li><a href='../button/btn_example11.html'>Color Picker Button (included with examples for Button Control)</a></li><li><a href='../button/btn_example12.html'>Fixed Width Menu Button (included with examples for Button Control)</a></li><li><a href='../button/btn_example14.html'>Slider Button (included with examples for Button Control)</a></li><li><a href='../layout/menu_layout.html'>Layout with Menu Controls (included with examples for Layout Manager)</a></li><li><a href='../profilerviewer/pv-api.html'>Using the ProfilerViewer API while Profiling the YUI Menu Control (included with examples for ProfilerViewer Control (beta))</a></li>							</ul>
						</div>
					</div>
					
					<div id="module">
						<h3>More Menu Family Resources:</h3>
						<ul>
							<li><a href="http://developer.yahoo.com/yui/menu/">User's Guide</a></li>
						<li><a href="../../docs/module_menu.html">API Documentation</a></li>
                            
                            
							<li><a href="http://yuiblog.com/assets/pdf/cheatsheets/menu.pdf">Cheat Sheet PDF</a></li></ul>
					</div>
			  </div>
		</div>
		
		</div>
	</div>


	<?php 
	$append = "

<script src='../../assets/YUIexamples.js'></script>

";
	include("../../inc/side.inc");
	include("../../inc/footer.inc");
	?>